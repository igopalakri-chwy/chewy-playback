{
  "query_1": "with chris_orders as (\n    select \n        customer_id, \n        order_id, \n        order_date_est, \n        channel, \n        budget, \n        goal,\n        campaign,\n        campaign_id,\n        network, \n        business_channel\n    from \n        mkt_sandbox.TBL_CUSTOMER_ORDER_AGGREGATE \n    where \n        order_date_est between '2024-01-01' and '2024-12-31'\n        and customer_id = {customer_id}\n),\ncustid_orderid_prodid as (\n    select\n        customer_id,\n        order_line_id,\n        order_id,\n        product_id,\n        order_line_quantity,\n        order_status\n    from \n        edldb.ecom.order_line_base\n    where \n        order_status = 'D' \n        and customer_id = {customer_id}\n),\nproduct_details as (\n    select \n        product_id,\n        name,\n        category_level3\n    from edldb.pdm.product \n)\n\nselect \n    c_ord.customer_id,\n    c_ord.order_id,\n    c_ord.order_date_est,\n    cop_id.product_id,\n    cop_id.order_line_quantity,\n    pd.name,\n    pd.category_level3\nfrom \n    chris_orders as c_ord\n    LEFT JOIN custid_orderid_prodid as cop_id\n        ON c_ord.customer_id = cop_id.customer_id \n        AND c_ord.order_id = cop_id.order_id\n    LEFT JOIN product_details as pd\n        ON cop_id.product_id = pd.product_id\norder by \n    c_ord.order_date_est;",
  "query_2": "SELECT\n    pp.customer_id,\n    pp.pet_name,\n    pp.pet_type,\n    pp.pet_breed,\n    pp.weight,\n    pp.gender,\n    pp.pet_age,\n    pp.medication\nFROM edldb.chewybi.pet_profile_aggregate pp\nWHERE \n    pp.pp_status   = 'Active' and\n    pp.customer_id = {customer_id}",
  "query_3": "select \n    customer_id,\n    review_id,\n    review_title,\n    review_txt\nfrom edldb.cdm.customer_product_rating \nwhere (submission_tm BETWEEN '2024-01-01' AND '2024-12-31')\nand moderation_status = 'APPROVED' \nand review_txt is not null\nand TRY_TO_NUMBER(customer_id) = {customer_id}",
  "query_4": "WITH zip_counts AS (\n    SELECT\n        customer_id,\n        customer_address_zip,\n        customer_address_city,\n        COUNT(*) AS zip_freq\n    FROM edldb.chewybi.customer_addresses\n    WHERE customer_id = {customer_id}\n    GROUP BY customer_id, customer_address_zip, customer_address_city\n),\nranked_zip AS (\n    SELECT *,\n           ROW_NUMBER() OVER (\n               PARTITION BY customer_id\n               ORDER BY zip_freq DESC\n           ) AS rn\n    FROM zip_counts\n)\nSELECT customer_id, customer_address_zip, customer_address_city\nFROM ranked_zip\nWHERE rn = 1"
} 