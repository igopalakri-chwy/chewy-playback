{% extends "base.html" %}

{% block title %}Pet Experience - Customer {{ customer_id }} - Chewy Playback{% endblock %}

{% block content %}
<script>
// Dynamic styling based on data content
function getDynamicStyles(data) {
    const styles = {};
    
    // Food consumption styling
    const foodLbs = data.food_fun_fact ? parseFloat(data.food_fun_fact.total_food_lbs) || 0 : 0;
    if (foodLbs > 100) {
        styles.foodIcon = 'color: white; font-size: 70px;';
        styles.foodTitle = 'color: white; font-size: 28px;';
    } else if (foodLbs > 50) {
        styles.foodIcon = 'color: white; font-size: 60px;';
        styles.foodTitle = 'color: white; font-size: 24px;';
    } else {
        styles.foodIcon = 'color: white; font-size: 50px;';
        styles.foodTitle = 'color: white; font-size: 20px;';
    }
    
    return styles;
}



function animateFoodNumber() {
    const numberElement = document.getElementById('food-number');
    if (!numberElement) return;
    
    // Store the original content to preserve the "lbs" text
    const lbsSpan = numberElement.querySelector('.unit-text');
    
    // Extract just the number from the text content
    const textContent = numberElement.textContent;
    const finalNumber = parseInt(textContent.replace(/[^\d]/g, ''));
    let currentNumber = 0;
    const duration = 2000; // 2 seconds
    const steps = 60;
    const increment = finalNumber / steps;
    const stepDuration = duration / steps;
    
    const timer = setInterval(() => {
        currentNumber += increment;
        if (currentNumber >= finalNumber) {
            currentNumber = finalNumber;
            clearInterval(timer);
        }
        
        // Update only the number part, preserving the "lbs" span
        if (lbsSpan) {
            numberElement.innerHTML = Math.floor(currentNumber) + lbsSpan.outerHTML;
        } else {
            numberElement.innerHTML = Math.floor(currentNumber) + '<span class="unit-text" style="font-size: 32px; color: #D35400; font-weight: 900; display: inline-block;">lbs</span>';
        }
    }, stepDuration);
}

// Simple Breed Predictions Functions
function initializeBreedPredictions() {
    // Add hover effects to prediction items
    const predictionItems = document.querySelectorAll('[onclick*="handleBreedCardClick"]');
    predictionItems.forEach((item, index) => {
        item.addEventListener('mouseenter', function() {
            this.style.transform = 'scale(1.05)';
            this.style.boxShadow = '0 4px 12px rgba(16, 185, 129, 0.2)';
        });
        
        item.addEventListener('mouseleave', function() {
            this.style.transform = 'scale(1)';
            this.style.boxShadow = 'none';
        });
        
        // Add click animation
        item.addEventListener('click', function() {
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 150);
        });
    });
}

// Share Feature Cards Functions
function initializeShareCards() {
    const featureCards = document.querySelectorAll('.feature-card');
    featureCards.forEach((card) => {
        card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-4px) scale(1.02)';
            this.style.boxShadow = '0 8px 25px rgba(0, 0, 0, 0.15)';
            this.style.borderColor = 'rgba(255, 255, 255, 0.5)';
        });
        
        card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
            this.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.1)';
            this.style.borderColor = 'rgba(255, 255, 255, 0.3)';
        });
        
        card.addEventListener('click', function() {
            this.style.transform = 'scale(0.98)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 150);
        });
    });
    
    // Share button hover effects
    const shareBtn = document.querySelector('.enhanced-share-btn');
    if (shareBtn) {
        shareBtn.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-2px)';
            this.style.boxShadow = '0 8px 25px rgba(255, 215, 0, 0.4)';
        });
        
        shareBtn.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 6px 20px rgba(255, 215, 0, 0.3)';
        });
    }
}

// Initialize pie chart when DOM is loaded
document.addEventListener('DOMContentLoaded', function() {
    const customerData = JSON.parse('{{ customer_data | tojson | safe }}');
    const styles = getDynamicStyles(customerData);
    
    // Apply styles to elements
    const foodIcon = document.querySelector('.funfact-icon i');
    if (foodIcon) foodIcon.style.cssText = styles.foodIcon;
    
    const foodTitle = document.querySelector('.funfact-title');
    if (foodTitle) foodTitle.style.cssText = styles.foodTitle;
    
    // Animate the food number with counting effect
    animateFoodNumber();
    
    // Initialize breed predictions with delay to ensure elements are rendered
    setTimeout(() => {
        initializeBreedPredictions();
    }, 500);
    
    // Initialize share cards
    setTimeout(() => {
        initializeShareCards();
    }, 1000);
});
</script>

<style>
/* Base styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #002266 100%);
    min-height: 100vh;
    overflow-x: hidden;
}

/* Loading styles */
.loading {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    color: white;
    font-size: 24px;
    font-family: 'Poppins', sans-serif;
}

.loading h2 {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 40px;
    text-align: center;
}

.loading p {
    font-size: 18px;
    opacity: 0.8;
    text-transform: lowercase;
}

.container {
    width: 100%;
    height: 100vh;
    max-width: 100%;
    margin: 0;
    padding: 0;
    overflow-y: auto;
    overflow-x: hidden;
    background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #002266 100%);
    position: relative;
}

/* Slide styles */
.slide {
    display: none;
    min-height: 100vh;
    padding: 0;
    position: relative;
    margin: 0;
    width: 100%;
}

.slide.active {
    display: block;
}

.slide-content {
    background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #002266 100%);
    color: #333333;
    padding: 40px 25px 80px 25px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
    text-align: center;
    border-radius: 0;
    box-shadow: none;
    overflow-y: auto;
    margin: 0;
    box-sizing: border-box;
    position: relative;
}

/* Special handling for breed slide content */
.breed-slide .slide-content {
    overflow-y: auto;
    height: 100%;
    padding: 40px 25px 120px 25px;
    position: relative;
    z-index: 1;
}

/* Special handling for letter slide content */
.letter-slide .slide-content {
    overflow: hidden;
    height: 100vh;
    padding: 40px 25px;
    position: relative;
    z-index: 1;
    -ms-overflow-style: none;  /* Internet Explorer 10+ */
    scrollbar-width: none;  /* Firefox */
}

.letter-slide .slide-content::-webkit-scrollbar {
    display: none;  /* Safari and Chrome */
}

/* Ensure all breed slide elements can scroll */
.breed-slide * {
    box-sizing: border-box;
}

/* Increase bottom spacing for breed container */
.breed-container {
    max-width: 100%;
    margin: 0 auto;
    padding: 20px 20px 40px 20px;
    min-height: 100%;
    display: flex;
    flex-direction: column;
    gap: 20px;
    position: relative;
    z-index: 2;
}



/* Slide counter */
.slide-counter {
    position: absolute;
    top: 25px;
    right: 25px;
    background: rgba(0, 102, 204, 0.9);
    color: white;
    padding: 8px 12px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 500;
    backdrop-filter: blur(10px);
    z-index: 10;
}

/* Progress Bar */
.progress-bar-container {
    position: absolute;
    top: 70px;
    left: 25px;
    right: 25px;
    display: flex;
    gap: 4px;
    z-index: 100;
    height: 3px;
}

.progress-chunk {
    flex: 1;
    height: 3px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 2px;
    position: relative;
    overflow: hidden;
}

.progress-chunk-fill {
    height: 100%;
    background: linear-gradient(90deg, #FFD93D, #FF6B6B, #4ECDC4, #A29BFE);
    background-size: 300% 100%;
    animation: progressShimmer 2s ease-in-out infinite;
    border-radius: 2px;
    width: 0%;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: 0 0 8px rgba(255,255,255,0.4);
}

@keyframes progressShimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Food Fun Fact Slide */

.food-consumption-title {
    color: #333333;
    font-size: 48px;
    font-weight: 700;
    margin: 20px 0 10px 0;
    font-family: 'Poppins', sans-serif;
}

.food-consumption-subtitle {
    color: #333333;
    font-size: 18px;
    font-weight: 400;
    margin-bottom: 30px;
    font-family: 'Poppins', sans-serif;
    opacity: 0.9;
}

.funfact-messages {
    text-align: left;
    max-width: 90%;
    margin: 0 auto;
}

.funfact-message {
    color: #333333;
    font-size: 20px;
    line-height: 1.6;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    margin-bottom: 15px;
    padding: 15px;
    background: rgba(0, 102, 204, 0.1);
    border-radius: 10px;
    border-left: 4px solid rgba(255, 255, 255, 0.3);
}

/* Highlight number + item format in fun facts */
.funfact-message .highlight-number {
    font-weight: 700;
    color: #333333;
}



/* Spotify Wrapped Style */
.spotify-wrapped-container {
    text-align: center;
    padding: 40px 20px;
    max-width: 100%;
    margin: 0 auto;
    min-height: auto;
    overflow: visible;
}

.wrapped-text-line {
    color: white;
    font-size: 18px;
    font-weight: 400;
    font-family: 'Poppins', sans-serif;
    margin-bottom: 8px;
    opacity: 0.9;
    animation: fadeInUp 0.8s ease-out;
}

.wrapped-number {
    color: white;
    font-size: 64px;
    font-weight: 800;
    font-family: 'Poppins', sans-serif;
    margin: 20px 0;
    animation: numberPop 1.2s ease-out;
    text-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    line-height: 1;
    overflow: visible;
    display: block;
    width: 100%;
}

.wrapped-highlight {
    color: white;
    font-size: 24px;
    font-weight: 700;
    font-family: 'Poppins', sans-serif;
    margin-bottom: 12px;
    animation: slideInRight 0.8s ease-out;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

/* Animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes numberPop {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(50px);
    }
    50% {
        transform: scale(1.1) translateY(-10px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideInUp {
    from {
        opacity: 0;
        transform: translate(-50%, -40%);
    }
    to {
        opacity: 1;
        transform: translate(-50%, -50%);
    }
}

@keyframes slideInFromBottom {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fadeInScale {
    from {
        opacity: 0;
        transform: scale(0.9);
    }
    to {
        opacity: 1;
        transform: scale(1);
    }
}



.funfact-icon {
    margin-bottom: 15px;
}

.funfact-content {
    background: rgba(0, 102, 204, 0.15);
    padding: 20px 15px;
    border-radius: 12px;
    backdrop-filter: blur(10px);
    margin: 10px 0;
    border: 1px solid rgba(0, 102, 204, 0.3);
}

.funfact-title {
    color: white;
    font-size: 24px;
    font-weight: 600;
    margin: 20px 0 15px 0;
    font-family: 'Poppins', sans-serif;
}

.funfact-highlight {
    background: linear-gradient(135deg, #0066cc, #004499);
    padding: 20px;
    border-radius: 12px;
    margin-top: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

/* Slide title styling */
.slide-title {
    color: #333333 !important;
    font-size: 28px;
    font-weight: 700;
    margin: 30px 0 20px 0;
    text-align: center;
    font-family: 'Poppins', sans-serif;
    animation: none !important;
    transition: none !important;
    transform: none !important;
    background: none !important;
    background-image: none !important;
    -webkit-background-clip: initial !important;
    background-clip: initial !important;
    -webkit-text-fill-color: #333333 !important;
    text-shadow: none !important;
    filter: none !important;
}

.funfact-text {
    color: white;
    font-size: 16px;
    line-height: 1.6;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
}

/* Busiest Month Slide */
.busiest-container {
    max-width: 800px;
    margin: 0 auto;
}

.busiest-icon {
    margin-bottom: 30px;
}

.busiest-content {
    background: rgba(255,255,255,0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
}

.busiest-title {
    color: white;
    font-size: 32px;
    margin-bottom: 30px;
}

.busiest-highlight {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    padding: 25px;
    border-radius: 15px;
    margin-top: 20px;
}

.busiest-text {
    color: white;
    font-size: 18px;
    line-height: 1.6;
}

/* Portrait Slide */
.portrait-container {
    max-width: 800px;
    margin: 0 auto;
}

.portrait-image {
    max-width: 100%;
    height: auto;
    border-radius: 20px;
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
    margin-bottom: 30px;
}

/* Letter Slide */
.letter-container {
    max-width: 700px;
    margin: 0 auto;
    background: rgba(255,255,255,0.1);
    padding: 20px;
    border-radius: 12px;
    backdrop-filter: blur(10px);
    display: block;
    color: white;
    font-size: 14px;
    line-height: 1.4;
    text-align: left;
    white-space: pre-line;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    width: 100%;
    box-sizing: border-box;
    border: 1px solid rgba(255,255,255,0.2);
}

.letter-container p {
    margin: 0;
    padding: 0;
    line-height: 1.2;
}



/* Badge Slide */
.badge-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
}

.badge-image {
    max-width: 300px;
    height: auto;
    margin-bottom: 30px;
    border-radius: 15px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.3);
}

.badge-title {
    color: white;
    font-size: 24px;
    margin: 20px 0 15px 0;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
}

.badge-description {
    color: white;
    font-size: 16px;
    line-height: 1.6;
    background: rgba(0, 102, 204, 0.15);
    padding: 20px 15px;
    border-radius: 12px;
    backdrop-filter: blur(10px);
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    border: 1px solid rgba(0, 102, 204, 0.3);
    margin: 10px 0;
}

/* Breed Slide */
.breed-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
}

.breed-title {
    color: white;
    font-size: 32px;
    margin-bottom: 30px;
}

.breed-content {
    background: rgba(255,255,255,0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
}

.breed-name {
    color: white;
    font-size: 36px;
    font-weight: bold;
    margin-bottom: 20px;
}

.breed-description {
    color: white;
    font-size: 18px;
    line-height: 1.6;
}

/* Breed Pet Highlight */
.breed-pet-highlight {
    text-align: center;
    margin-bottom: 25px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(74, 144, 226, 0.3), rgba(42, 82, 152, 0.3));
    border-radius: 20px;
    border: 2px solid rgba(74, 144, 226, 0.4);
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 25px rgba(74, 144, 226, 0.2);
    animation: fadeInUp 0.8s ease-out;
}

.breed-highlight-text {
    color: white;
    font-size: 20px;
    line-height: 1.5;
    margin: 0;
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
}

.breed-highlight-text strong {
    color: white;
    font-weight: 700;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

/* Breed Predictions - Simple List Style */
.breed-predictions-card {
    margin-bottom: 15px;
    animation: fadeInUp 0.8s ease-out;
}

/* Breed Grid Animation */
.breed-grid-animation {
    opacity: 0;
    transform: translateY(30px);
    animation: breedGridSlideIn 1s ease-out 0.2s forwards;
}

.breed-predictions-grid {
    margin-bottom: 0;
}

@keyframes breedGridSlideIn {
    0% {
        opacity: 0;
        transform: translateY(30px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

.breed-predictions-title {
    color: white;
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 15px;
    text-align: center;
    font-family: 'Poppins', sans-serif;
}

.breed-predictions-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.breed-prediction-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.breed-prediction-item:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateX(5px);
}

.breed-prediction-info {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.breed-prediction-name {
    color: white;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
}

.breed-prediction-percentage {
    color: rgba(255, 255, 255, 0.8);
    font-size: 16px;
    font-weight: 500;
}

.breed-prediction-check {
    display: flex;
    align-items: center;
    gap: 10px;
}

.breed-checkbox {
    width: 20px;
    height: 20px;
    accent-color: #4a90e2;
    cursor: pointer;
}

.breed-checkbox-label {
    color: white;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    font-family: 'Poppins', sans-serif;
}

/* Enhanced Breed Card Hover Effects */
.breed-card:hover {
    transform: translateY(-6px) scale(1.05);
    box-shadow: 0 12px 32px rgba(28, 58, 46, 0.25);
    background: linear-gradient(135deg, #FFFFFF 0%, #F8FAFC 100%);
    border: 2px solid rgba(28, 58, 46, 0.3);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.breed-card:active {
    transform: translateY(-2px) scale(1.02);
    transition: all 0.1s ease;
}

.breed-card {
    position: relative;
    overflow: hidden;
}

.breed-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    transition: left 0.5s ease;
}

.breed-card:hover::before {
    left: 100%;
}

/* Question Card - Simple Style */
.breed-question-card {
    margin-bottom: 25px;
    animation: fadeInUp 0.8s ease-out;
}

.breed-question-title {
    color: white;
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 25px;
    text-align: center;
    font-family: 'Poppins', sans-serif;
}

/* Question Text Animation */
.question-text-animation {
    opacity: 0;
    transform: translateY(20px);
    animation: questionTextSlideIn 0.8s ease-out 1.5s forwards;
}

/* Question Options Animation */
.options-animation {
    opacity: 0;
    transform: translateY(20px);
    animation: optionsSlideIn 0.8s ease-out 2s forwards;
}

@keyframes questionTextSlideIn {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes optionsSlideIn {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

.breed-question-options {
    display: flex;
    justify-content: center;
    gap: 30px;
}

.breed-question-option {
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
    padding: 15px 25px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.breed-question-option:hover {
    background: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
}

.breed-question-option input[type="radio"] {
    width: 18px;
    height: 18px;
    accent-color: #4a90e2;
}

.breed-question-text {
    color: white;
    font-size: 16px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
}

/* Yes Response - Simple Style */
.breed-yes-response {
    margin-bottom: 25px;
    animation: fadeInUp 0.8s ease-out;
}

.breed-response-title {
    color: white;
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 25px;
    text-align: center;
    font-family: 'Poppins', sans-serif;
}

.breed-correct-list {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.breed-correct-item {
    display: flex;
    align-items: center;
    gap: 20px;
    padding: 20px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    border: 1px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
}

.breed-correct-item:hover {
    background: rgba(255, 255, 255, 0.15);
}

.breed-correct-check {
    display: flex;
    align-items: center;
    gap: 10px;
}

.breed-correct-info {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.breed-correct-name {
    color: white;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
}

.breed-correct-reason {
    color: rgba(255, 255, 255, 0.8);
    font-size: 14px;
    font-style: italic;
}

/* No Response - Simple Style */
.breed-no-response {
    margin-bottom: 25px;
    animation: fadeInUp 0.8s ease-out;
}

.breed-profile-input-section {
    text-align: center;
}

.breed-profile-text {
    color: white;
    font-size: 16px;
    margin-bottom: 20px;
    font-family: 'Poppins', sans-serif;
}

.breed-profile-input {
    width: 100%;
    max-width: 400px;
    padding: 15px;
    border-radius: 10px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.1);
    color: white;
    font-size: 16px;
    margin-bottom: 20px;
    font-family: 'Poppins', sans-serif;
}

.breed-profile-input::placeholder {
    color: rgba(255, 255, 255, 0.6);
}

.breed-profile-input:focus {
    outline: none;
    border-color: #4a90e2;
    background: rgba(255, 255, 255, 0.15);
}

.breed-profile-submit-btn {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
}

.breed-profile-submit-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}



.breed-prediction-card .breed-name {
    color: white;
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 10px;
}

.breed-prediction-card .breed-percentage {
    color: white;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 5px;
}

.breed-prediction-card .breed-pet-name {
    color: rgba(255,255,255,0.8);
    font-size: 16px;
    margin-bottom: 10px;
}

.breed-prediction-card .breed-click-hint {
    color: rgba(255,255,255,0.6);
    font-size: 12px;
    font-style: italic;
}

.breed-question-section {
    margin-top: 10px;
    text-align: center;
    padding: 20px;
    background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
    border-radius: 25px;
    backdrop-filter: blur(15px);
    border: 2px solid rgba(255,255,255,0.2);
    animation: fadeInUp 1s ease-out 0.5s both;
}

.breed-question {
    color: white;
    font-size: 28px;
    margin-bottom: 25px;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.breed-answer-buttons {
    display: flex;
    justify-content: center;
    gap: 25px;
}

.breed-answer-btn {
    padding: 15px 35px;
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    border: none;
    border-radius: 30px;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    transition: all 0.4s ease;
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.3);
    border: 2px solid rgba(255,255,255,0.2);
}

.breed-answer-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 30px rgba(74, 144, 226, 0.5);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}

/* Enhanced breed question button hover effects */
.breed-question-btn:hover {
    transform: translateY(-4px) scale(1.05);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.breed-question-btn:hover .breed-btn-emoji {
    transform: scale(1.1);
    transition: transform 0.2s ease;
}

.breed-question-btn:active {
    transform: translateY(-2px) scale(1.02);
    transition: all 0.1s ease;
}

.breed-feedback-yes,
.breed-feedback-no {
    margin-top: 30px;
    text-align: center;
    padding: 30px;
    background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
    border-radius: 25px;
    backdrop-filter: blur(15px);
    border: 2px solid rgba(255,255,255,0.2);
    animation: fadeInUp 1s ease-out;
}

.breed-feedback-yes h4,
.breed-feedback-no h4 {
    color: white;
    font-size: 26px;
    margin-bottom: 25px;
    font-family: 'Poppins', sans-serif;
    font-weight: 600;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.breed-checkboxes {
    display: flex;
    flex-direction: column;
    gap: 15px;
    margin-bottom: 25px;
    text-align: left;
}

.breed-checkbox-item {
    display: flex;
    align-items: center;
    gap: 15px;
    padding: 20px;
    background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
    border-radius: 15px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
    transition: all 0.3s ease;
}

.breed-checkbox-item:hover {
    background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.08));
    transform: translateX(5px);
}

.breed-checkbox {
    width: 22px;
    height: 22px;
    accent-color: #4a90e2;
    cursor: pointer;
}

.breed-checkbox-item label {
    color: white;
    font-size: 16px;
    cursor: pointer;
    flex: 1;
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
}

.breed-feedback-text {
    color: rgba(255,255,255,0.9);
    font-size: 18px;
    line-height: 1.6;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    margin-bottom: 25px;
}

.breed-profile-link {
    margin-top: 25px;
}

.breed-profile-btn {
    display: inline-block;
    padding: 15px 35px;
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    text-decoration: none;
    border-radius: 30px;
    font-size: 18px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
    transition: all 0.4s ease;
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.3);
    border: 2px solid rgba(255,255,255,0.2);
}

.breed-profile-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 10px 30px rgba(74, 144, 226, 0.5);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}

/* Breed Flashcard Modal - Neutral Subtle Style */
.breed-flashcard-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(44, 95, 139, 0.85);
    z-index: 1000;
    backdrop-filter: blur(15px);
    animation: fadeIn 0.3s ease-out;
}

.breed-flashcard-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #F8FAFC 0%, #F1F5F9 100%);
    border-radius: 20px;
    padding: 30px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 20px 40px rgba(44, 95, 139, 0.25);
    border: 1px solid rgba(255, 255, 255, 0.9);
    animation: slideInUp 0.4s ease-out;
    position: relative;
}

.breed-flashcard-content::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: 
        radial-gradient(circle at 30% 70%, rgba(44, 95, 139, 0.03) 0%, transparent 50%),
        radial-gradient(circle at 70% 30%, rgba(74, 144, 226, 0.02) 0%, transparent 50%);
    border-radius: 20px;
    pointer-events: none;
}

.breed-flashcard-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 25px;
    position: relative;
    z-index: 2;
}

.breed-flashcard-header h3 {
    color: #2C5F8B;
    font-size: 24px;
    margin: 0;
    font-family: 'Poppins', sans-serif;
    font-weight: 700;
    text-shadow: 0 1px 2px rgba(44, 95, 139, 0.1);
}

.breed-flashcard-close {
    background: rgba(44, 95, 139, 0.1);
    color: #2C5F8B;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(44, 95, 139, 0.2);
}

.breed-flashcard-close:hover {
    background: rgba(44, 95, 139, 0.2);
    transform: scale(1.05);
}

.breed-flashcard-body {
    color: #4A5F6B;
    position: relative;
    z-index: 2;
}

.breed-flashcard-info {
    display: flex;
    justify-content: space-between;
    margin-bottom: 25px;
    padding: 20px;
    background: rgba(255,255,255,0.15);
    border-radius: 15px;
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.2);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.breed-flashcard-pet,
.breed-flashcard-confidence {
    font-size: 18px;
    color: rgba(255,255,255,0.95);
    font-family: 'Poppins', sans-serif;
    font-weight: 500;
}

.breed-flashcard-description {
    font-size: 16px;
    line-height: 1.7;
    background: rgba(255,255,255,0.1);
    padding: 25px;
    border-radius: 20px;
    backdrop-filter: blur(15px);
    border: 1px solid rgba(255,255,255,0.2);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    font-family: 'Poppins', sans-serif;
}

/* Stats Slide */

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-top: 30px;
    margin-bottom: 30px;
    width: 100%;
}

.stat-card {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.15));
    padding: 25px;
    border-radius: 15px;
    text-align: center;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(60, 60, 60, 0.3);
    transition: all 0.3s ease;
    min-height: 120px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    box-shadow: 
        0 12px 40px rgba(60, 60, 60, 0.2),
        0 0 0 1px rgba(255, 255, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
}

.stat-card:hover {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.3), rgba(255, 255, 255, 0.2));
    transform: translateY(-8px) scale(1.02);
    box-shadow: 
        0 16px 48px rgba(60, 60, 60, 0.25),
        0 0 0 1px rgba(255, 255, 255, 0.4);
}

.stat-value {
    color: #3C3C3C;
    font-size: 28px;
    font-weight: bold;
    margin-bottom: 10px;
    text-shadow: 0 2px 8px rgba(60, 60, 60, 0.2);
}

.stat-label {
    font-size: 16px;
    color: #4A1A1A;
    line-height: 1.4;
    font-weight: 500;
    font-family: 'Poppins', sans-serif;
}

.stat-card .stat-product {
    font-size: 12px;
    color: #00373C;
    margin-top: 8px;
    line-height: 1.3;
    font-family: 'Poppins', sans-serif;
}

/* Arrow Navigation */
.slide-arrow-nav {
    position: fixed;
    top: 50%;
    transform: translateY(-50%);
    z-index: 100;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 60px;
    height: 60px;
    background: rgba(255,255,255,0.2);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
}

.slide-arrow-nav:hover {
    background: rgba(255,255,255,0.3);
    transform: translateY(-50%) scale(1.1);
    box-shadow: 0 5px 15px rgba(255,255,255,0.2);
}

.slide-arrow-nav.prev {
    left: 25px;
}

.slide-arrow-nav.next {
    right: 25px;
}

.slide-arrow-nav i {
    color: white;
    font-size: 24px;
}

.slide-arrow-nav:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.slide-arrow-nav:disabled:hover {
    transform: translateY(-50%);
    background: rgba(255,255,255,0.2);
    box-shadow: none;
}

.stat-label {
    color: white;
    font-size: 16px;
}

/* Feature Card Styles */
.feature-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.6);
    background: rgba(255, 255, 255, 0.25);
}

.feature-card.selected {
    background: rgba(74, 144, 226, 0.4);
    border-color: #4a90e2;
    box-shadow: 0 8px 20px rgba(74, 144, 226, 0.4);
    transform: translateY(-2px);
}

.feature-card.selected::after {
    content: '✓';
    position: absolute;
    top: 8px;
    right: 8px;
    background: #4a90e2;
    color: white;
    font-size: 12px;
    font-weight: bold;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* iOS Share Sheet Styles */
.ios-share-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.4);
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    border-radius: 32px;
    overflow: hidden;
}

.ios-share-overlay.show {
    opacity: 1;
    visibility: visible;
}

.ios-share-sheet {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background: #f2f2f7;
    border-radius: 20px 20px 0 0;
    transform: translateY(100%);
    transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    max-height: 80vh;
    overflow-y: auto;
}

.ios-share-overlay.show .ios-share-sheet {
    transform: translateY(0);
}

.share-options-section {
    background: white;
    border-radius: 20px 20px 0 0;
    padding: 20px;
    margin-bottom: 8px;
}

.share-apps-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 20px;
    justify-items: center;
}

.share-app-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.share-app-item:active {
    transform: scale(0.95);
}

.share-app-icon {
    width: 60px;
    height: 60px;
    border-radius: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.share-app-label {
    font-size: 12px;
    color: #000;
    text-align: center;
    font-weight: 400;
    max-width: 70px;
    line-height: 1.2;
}

.share-actions-section {
    background: white;
    border-radius: 12px;
    margin: 0 16px 8px 16px;
    overflow: hidden;
}

.share-action-item {
    display: flex;
    align-items: center;
    padding: 16px;
    border-bottom: 0.5px solid #e5e5ea;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.share-action-item:last-child {
    border-bottom: none;
}

.share-action-item:active {
    background-color: #f0f0f0;
}

.share-action-icon {
    margin-right: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.share-action-text {
    flex: 1;
}

.share-action-title {
    font-size: 16px;
    color: #007AFF;
    font-weight: 400;
}

.share-cancel-section {
    background: white;
    border-radius: 12px;
    margin: 0 16px 16px 16px;
    overflow: hidden;
}

.share-cancel-btn {
    width: 100%;
    padding: 16px;
    background: none;
    border: none;
    font-size: 16px;
    color: #007AFF;
    font-weight: 400;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.share-cancel-btn:active {
    background-color: #f0f0f0;
}

/* Social Media Slide */
.share-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
}

.share-title {
    color: white;
    font-size: 36px;
    margin-bottom: 30px;
}

.share-content {
    background: rgba(255,255,255,0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
}

.share-text {
    color: white;
    font-size: 20px;
    line-height: 1.6;
    margin-bottom: 30px;
}

/* Enhanced Social Media Sharing */
.enhanced-share-container {
    max-width: 600px;
    margin: 0 auto;
    padding: 15px;
}

.enhanced-share-content {
    background: rgba(255, 255, 255, 0.15);
    padding: 30px 25px;
    border-radius: 20px;
    backdrop-filter: blur(15px);
    border: 2px solid rgba(255, 255, 255, 0.2);
    box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
    position: relative;
    overflow: hidden;
}

.enhanced-share-content::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(74, 144, 226, 0.1), rgba(42, 82, 152, 0.1));
    pointer-events: none;
}

.enhanced-share-text {
    text-align: center;
    margin-bottom: 25px;
    position: relative;
    z-index: 1;
}

.enhanced-social-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
    margin: 30px 0;
    position: relative;
    z-index: 1;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
}

.enhanced-social-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 18px 15px;
    border-radius: 16px;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    background: rgba(255, 255, 255, 0.1);
    border: 2px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
    min-height: 90px;
}

.enhanced-social-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), rgba(255, 255, 255, 0.05));
    opacity: 0;
    transition: opacity 0.3s ease;
}

.enhanced-social-card:hover {
    transform: translateY(-8px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.4);
}

.enhanced-social-card:hover::before {
    opacity: 1;
}

.enhanced-social-icon {
    margin-bottom: 8px;
    position: relative;
    z-index: 1;
}

.enhanced-social-icon i {
    font-size: 28px;
    color: white;
    transition: all 0.3s ease;
}

.enhanced-social-label {
    color: white;
    font-size: 12px;
    font-weight: 600;
    text-align: center;
    position: relative;
    z-index: 1;
    font-family: 'Poppins', sans-serif;
}

/* Enhanced Social Media Brand Colors */
.enhanced-social-card.facebook:hover {
    background: linear-gradient(135deg, #1877f2, #0d6efd);
    border-color: #1877f2;
    box-shadow: 0 20px 40px rgba(24, 119, 242, 0.4);
}

.enhanced-social-card.instagram:hover {
    background: linear-gradient(135deg, #e4405f, #c13584);
    border-color: #e4405f;
    box-shadow: 0 20px 40px rgba(228, 64, 95, 0.4);
}

.enhanced-social-card.snapchat:hover {
    background: linear-gradient(135deg, #fffc00, #ffd700);
    border-color: #fffc00;
    box-shadow: 0 20px 40px rgba(255, 252, 0, 0.4);
}

.enhanced-social-card.snapchat:hover .enhanced-social-icon i,
.enhanced-social-card.snapchat:hover .enhanced-social-label {
    color: #333;
}

.enhanced-social-card.message:hover {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    border-color: #4a90e2;
    box-shadow: 0 20px 40px rgba(74, 144, 226, 0.4);
}

.enhanced-share-cta {
    text-align: center;
    margin-top: 25px;
    position: relative;
    z-index: 1;
}

.enhanced-share-btn {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    border: none;
    padding: 15px 32px;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 700;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 0 auto;
    position: relative;
    overflow: hidden;
}

.enhanced-share-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s ease;
}

.enhanced-share-btn:hover::before {
    left: 100%;
}

.enhanced-share-btn:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 15px 35px rgba(74, 144, 226, 0.6);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}

.enhanced-share-icon {
    font-size: 18px;
}

.enhanced-share-text {
    font-weight: 700;
}

/* Legacy Social Media Icons (keeping for compatibility) */
.social-media-icons {
    display: flex;
    justify-content: center;
    gap: 25px;
    margin: 40px 0;
    flex-wrap: wrap;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
}

.social-icon {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    padding: 20px;
    border-radius: 15px;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 100px;
    background: rgba(255,255,255,0.1);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255,255,255,0.2);
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.social-icon:hover {
    transform: translateY(-5px) scale(1.05);
    box-shadow: 0 15px 35px rgba(0,0,0,0.3);
    border-color: rgba(255,255,255,0.4);
}

.social-icon i {
    font-size: 32px;
    color: white;
}

.social-label {
    color: white;
    font-size: 12px;
    font-weight: bold;
    text-align: center;
}

/* Social Media Brand Colors */
.social-icon.facebook:hover {
    background: linear-gradient(135deg, #1877f2, #0d6efd);
    border-color: #1877f2;
}

.social-icon.snapchat:hover {
    background: linear-gradient(135deg, #fffc00, #ffd700);
    border-color: #fffc00;
}

.social-icon.snapchat:hover i,
.social-icon.snapchat:hover .social-label {
    color: white;
}

.social-icon.instagram:hover {
    background: linear-gradient(135deg, #e4405f, #c13584);
    border-color: #e4405f;
}

.social-icon.whatsapp:hover {
    background: linear-gradient(135deg, #25d366, #128c7e);
    border-color: #25d366;
}

.social-icon.message:hover {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    border-color: #4a90e2;
}

/* Share CTA Button */
.share-cta-button {
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    border: none;
    padding: 15px 30px;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 0 auto;
}

.share-cta-button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}

.share-btn-icon {
    font-size: 18px;
}

.share-btn-text {
    font-size: 16px;
    font-weight: 600;
}

/* Share Container Enhancements */
.share-container {
    max-width: 800px;
    margin: 0 auto;
    text-align: center;
    padding: 20px;
}

.share-content {
    background: rgba(255,255,255,0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255,255,255,0.2);
}

.share-text {
    color: white;
    font-size: 18px;
    line-height: 1.6;
    margin-bottom: 30px;
    font-family: 'Poppins', sans-serif;
}

.share-text p {
    margin-bottom: 10px;
    font-weight: 400;
}

.share-cta-section {
    margin-top: 30px;
    text-align: center;
}

/* Unknowns Slide */
.unknowns-container {
    max-width: 800px;
    margin: 0 auto;
}

.unknowns-title {
    color: white;
    font-size: 32px;
    margin-bottom: 30px;
    text-align: center;
}

.unknowns-content {
    background: rgba(255,255,255,0.1);
    padding: 40px;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    text-align: left;
}

.unknowns-text {
    color: white;
    font-size: 16px;
    line-height: 1.6;
    white-space: pre-wrap;
}

/* Unknowns Enhanced Styles */
.unknowns-summary {
    text-align: center;
    margin-bottom: 30px;
}

.unknowns-summary-text {
    color: white;
    font-size: 18px;
    line-height: 1.6;
    font-family: 'Poppins', sans-serif;
    font-weight: 400;
    margin-bottom: 15px;
}

.unknowns-pets-grid {
    display: flex;
    flex-direction: column;
    gap: 25px;
    margin-bottom: 30px;
}

.unknowns-pet-card {
    background: rgba(255,255,255,0.1);
    padding: 25px;
    border-radius: 15px;
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255,255,255,0.2);
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.unknowns-pet-card:hover {
    background: rgba(255,255,255,0.15);
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.unknowns-pet-name {
    color: white;
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
    text-align: center;
}

.unknowns-pet-name .emoji {
    margin-right: 10px;
}

.unknowns-fields-container {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
}

.unknowns-field-box {
    background: linear-gradient(135deg, #ff6b6b, #ee5a52);
    color: white;
    padding: 12px 20px;
    border-radius: 25px;
    font-size: 14px;
    font-weight: bold;
    text-align: center;
    box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
    transition: all 0.3s ease;
    font-family: 'Poppins', sans-serif;
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.unknowns-field-box:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
}

.unknowns-action {
    text-align: center;
    margin-top: 30px;
}

.unknowns-action-text {
    color: rgba(255,255,255,0.9);
    font-size: 16px;
    line-height: 1.5;
    margin-bottom: 20px;
}

.unknowns-profile-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 15px 30px;
    background: linear-gradient(135deg, #4a90e2, #2a5298);
    color: white;
    text-decoration: none;
    border-radius: 25px;
    font-size: 16px;
    font-weight: 600;
    font-family: 'Poppins', sans-serif;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(74, 144, 226, 0.3);
}

.unknowns-profile-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(74, 144, 226, 0.4);
    background: linear-gradient(135deg, #5aa0f2, #3a62a8);
}

.profile-btn-icon {
    font-size: 18px;
}

.profile-btn-text {
    font-size: 16px;
    font-weight: 600;
}




/* Responsive */
@media (max-width: 768px) {
    .container {
        padding: 0;
        height: 100vh;
        overflow-y: auto;
    }
    
    .slide-content {
        padding: 30px 15px;
    }
    
    .funfact-content,
    .letter-container,
    .breed-content,
    .share-content,
    .unknowns-content {
        padding: 25px;
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    /* Mobile portrait centering */
    .portrait-image-fullscreen {
        width: auto !important;
        height: auto !important;
        max-width: 95% !important;
        max-height: 70vh !important;
        object-fit: contain !important;
    }
    
    .portrait-slide {
        display: flex !important;
        flex-direction: column !important;
        justify-content: center !important;
        align-items: center !important;
        min-height: 100vh !important;
        padding: 10px !important;
    }
    
    /* Mobile breed predictions */
    .breed-predictions-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 10px !important;
    }
    
    .breed-card {
        min-height: 80px !important;
        padding: 12px 8px !important;
    }
    
    .breed-card-name {
        font-size: 12px !important;
        margin-bottom: 4px !important;
    }
    
    .breed-card-percentage {
        font-size: 16px !important;
    }
}

@media (max-width: 480px) {
    .breed-predictions-grid {
        grid-template-columns: 1fr !important;
        gap: 8px !important;
    }
    
    .breed-card {
        min-height: 70px !important;
        padding: 10px 8px !important;
    }
    
    .breed-card-name {
        font-size: 11px !important;
    }
    
    .breed-card-percentage {
        font-size: 14px !important;
    }
}

/* Enhanced Food Consumption Animations */
@keyframes floatFood {
    0%, 100% {
        transform: translateY(0px) rotate(0deg);
    }
    25% {
        transform: translateY(-10px) rotate(2deg);
    }
    50% {
        transform: translateY(-5px) rotate(-1deg);
    }
    75% {
        transform: translateY(-15px) rotate(1deg);
    }
}

@keyframes orbFloat {
    0%, 100% {
        transform: translateY(0px) scale(1);
        opacity: 0.2;
    }
    50% {
        transform: translateY(-20px) scale(1.1);
        opacity: 0.3;
    }
}

@keyframes titleSlideDownEnhanced {
    0% {
        opacity: 0;
        transform: translateY(-30px) scale(0.9);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

@keyframes numberPopUltraEnhanced {
    0% {
        opacity: 0;
        transform: scale(0.3) rotate(-10deg);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.2) rotate(2deg);
    }
    100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
}

@keyframes progressRingEnhanced {
    0% {
        stroke-dashoffset: 220;
    }
    100% {
        stroke-dashoffset: 0;
    }
}

@keyframes fadeInUpEnhanced {
    0% {
        opacity: 0;
        transform: translateY(20px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes bowlBounceEnhanced {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(30px);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.1) translateY(-10px);
    }
    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

@keyframes bowlGlow {
    0% {
        filter: drop-shadow(0 6px 12px rgba(168, 85, 247, 0.3));
    }
    100% {
        filter: drop-shadow(0 6px 12px rgba(168, 85, 247, 0.6));
    }
}

@keyframes slideInLeftEnhanced {
    0% {
        opacity: 0;
        transform: translateX(-30px) rotateY(-10deg);
    }
    100% {
        opacity: 1;
        transform: translateX(0) rotateY(0deg);
    }
}

@keyframes counterSlideIn {
    0% {
        opacity: 0;
        transform: translateY(20px) scale(0.8);
    }
    100% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

/* Additional Enhanced Animations */
@keyframes titleLineExpand {
    0% {
        width: 0;
        opacity: 0;
    }
    100% {
        width: 60px;
        opacity: 1;
    }
}

@keyframes numberGlow {
    0% {
        opacity: 0.2;
        filter: blur(8px);
    }
    100% {
        opacity: 0.5;
        filter: blur(12px);
    }
}

@keyframes sparkleTwinkle {
    0%, 100% {
        opacity: 0.3;
        transform: scale(1) rotate(0deg);
    }
    50% {
        opacity: 1;
        transform: scale(1.2) rotate(180deg);
    }
}

@keyframes iconFloat {
    0%, 100% {
        transform: translateY(0px) rotate(0deg);
        opacity: 0.1;
    }
    50% {
        transform: translateY(-5px) rotate(5deg);
        opacity: 0.2;
    }
}

/* Letter Slide Animations */
@keyframes floatLetter {
    0%, 100% {
        transform: translateY(0px) rotate(0deg);
    }
    25% {
        transform: translateY(-8px) rotate(2deg);
    }
    50% {
        transform: translateY(-4px) rotate(-1deg);
    }
    75% {
        transform: translateY(-12px) rotate(1deg);
    }
}

@keyframes letterSlideIn {
    0% {
        opacity: 0;
        transform: perspective(1000px) rotateX(2deg) translateY(30px) scale(0.9);
    }
    100% {
        opacity: 1;
        transform: perspective(1000px) rotateX(2deg) translateY(0) scale(1);
    }
}

@keyframes textFadeIn {
    0% {
        opacity: 0;
        transform: translateY(10px);
    }
    100% {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>

<div class="container">
    <!-- Progress Bar -->
    <div class="progress-bar-container" id="progress-bar-container">
        <!-- Progress chunks will be dynamically generated -->
    </div>
    
    <!-- Arrow Navigation -->
    <button class="slide-arrow-nav prev" id="prev-arrow" onclick="prevSlide()" disabled>
        <i class="fas fa-chevron-left"></i>
    </button>
    <button class="slide-arrow-nav next" id="next-arrow" onclick="nextSlide()">
        <i class="fas fa-chevron-right"></i>
    </button>

    <!-- Debug Info (temporary) -->
    <div style="position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.8); color: white; padding: 10px; border-radius: 5px; font-size: 12px; z-index: 1000;">
        <strong>Debug Info:</strong><br>
        Food Fun Fact: {{ customer_data.food_fun_fact is defined }}<br>
        Portrait: {{ customer_data.portrait is defined }}<br>
        Letter: {{ customer_data.letter is defined }}<br>
        Badge: {{ customer_data.badge is defined }}<br>
        Breed: {{ customer_data.breed_prediction is defined }}<br>
        Consolidated: {{ customer_data.consolidated_queries is defined }}<br>
        Unknowns: {{ customer_data.unknowns is defined }}
    </div>

    <!-- Loading Slide -->
    <div class="slide active" id="slide-0">
        <div class="slide-content loading-slide" style="background: linear-gradient(135deg, #0066cc 0%, #004499 50%, #002266 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center;">
            <div id="loading" class="loading">
                <h2>2025 Chewy Playback</h2>
                <p>loading</p>
            </div>
        </div>
    </div>

    <!-- Slide 1: Food Fun Fact -->
    {% if customer_data.food_fun_fact and customer_data.food_fun_fact.total_food_lbs and customer_data.food_fun_fact.total_food_lbs > 0 %}
    <div class="slide" id="slide-1">
        <div class="slide-content funfact-slide" style="background: #FFE181; color: #3C3C3C; min-height: 100vh; display: flex; flex-direction: column; justify-content: flex-start; align-items: center; padding-top: 80px;">
            <div class="slide-header" style="text-align: center; margin-bottom: 20px; color: #3C3C3C;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 40px; font-family: 'Nunito', sans-serif; font-weight: 600; color: #3C3C3C !important; font-size: 36px;">
                    Total Food Consumed
                </h2>
            </div>
            
            <div class="spotify-wrapped-container" style="text-align: center; width: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                <div class="wrapped-number" id="food-number" style="color: #4A1A1A; font-size: 48px; font-weight: 900; margin-bottom: 10px; text-align: center; width: 100%; display: flex; justify-content: center; align-items: center; gap: 8px;">{{ customer_data.food_fun_fact.total_food_lbs }}<span class="unit-text" style="font-size: 32px; color: #4A1A1A; font-weight: 900; display: inline-block;">lbs</span></div>
                <div class="wrapped-text-line" style="color: #3C3C3C; font-size: 18px; font-weight: 600; text-align: center; width: 100%;">to be exact.</div>
            </div>
            
            {% if customer_data.food_fun_fact.fun_facts %}
                {% for fun_fact in customer_data.food_fun_fact.fun_facts %}
                <p style="color: #3C3C3C; font-size: 16px; font-weight: 600; text-align: center; margin: 10px 0;">{{ fun_fact }}</p>
                {% endfor %}
            {% endif %}
            
            <div class="slide-counter">1 of 6</div>
        </div>
    </div>
    {% endif %}

    <!-- Slide 2: AI Portrait -->
    {% if customer_data.portrait %}
    <div class="slide" id="slide-2">
        <div class="slide-content portrait-slide" style="display: flex; flex-direction: column; justify-content: flex-start; align-items: center; min-height: 100vh; padding: 0; background: #FFB3B3; position: relative; overflow: hidden;">
            
            <!-- Animated background elements -->
            <div class="portrait-bg-elements" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;">
                <div class="bg-circle" style="position: absolute; top: 10%; right: 10%; width: 120px; height: 120px; background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 70%); border-radius: 50%; animation: float 6s ease-in-out infinite;"></div>
                <div class="bg-circle" style="position: absolute; bottom: 20%; left: 15%; width: 80px; height: 80px; background: radial-gradient(circle, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.03) 70%); border-radius: 50%; animation: float 8s ease-in-out infinite 2s;"></div>
                <div class="bg-circle" style="position: absolute; top: 60%; right: 20%; width: 60px; height: 60px; background: radial-gradient(circle, rgba(255,255,255,0.06) 0%, rgba(255,255,255,0.02) 70%); border-radius: 50%; animation: float 7s ease-in-out infinite 4s;"></div>
            </div>
            
            <!-- Title at the top -->
            <div class="slide-header" style="text-align: center; position: relative; z-index: 2; margin-top: 100px; margin-bottom: 20px;">
                <h2 class="slide-title" style="text-align: center; margin: 0; font-size: 28px; color: #5A1C2E; font-weight: 800; text-shadow: 0 2px 4px rgba(90,28,46,0.3);">
                    <strong>Your Pet Portrait</strong>
                </h2>
            </div>
            
            <!-- Portrait image centered in remaining space -->
            <div style="flex: 1; display: flex; align-items: center; justify-content: center; width: 100%;">
                <img src="{{ customer_data.portrait }}" alt="Pet Portrait" class="portrait-image-fullscreen" style="width: auto; height: auto; max-width: 90%; max-height: 70vh; object-fit: contain; display: block; margin: 0 auto;">
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Slide 1.5: Busiest Month (when food consumption is 0/null) -->
    {% if customer_data.cuddliest_month and (not customer_data.food_fun_fact or not customer_data.food_fun_fact.total_food_lbs or customer_data.food_fun_fact.total_food_lbs == 0) %}
    <div class="slide" id="slide-1-busiest">
        <div class="slide-content busiest-slide" style="background: #A0E7E5; color: #00373C;">
            <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 40px; color: #00373C;">
                    Your Busiest Month
                </h2>
            </div>
            
            <div class="busiest-container">
                <div class="busiest-icon">
                    <i class="fas fa-calendar-alt" style="font-size: 60px; color: #00373C;"></i>
                </div>
                <div class="busiest-content">
                    <h3 class="busiest-title" style="color: #00373C;">Your Busiest Month</h3>
                    <div style="background: rgba(255,255,255,0.2); padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                        <h4 style="color: #00373C; font-size: 32px; margin-bottom: 10px; text-align: center;">
                            {{ customer_data.cuddliest_month }}
                        </h4>
                        <p style="color: #00373C; font-size: 18px; text-align: center; margin-bottom: 15px;">
                            This was your most active month with Chewy!
                        </p>
                    </div>
                    <div class="busiest-highlight">
                        <p class="busiest-text" style="color: #00373C;">
                            You were most engaged with Chewy during {{ customer_data.cuddliest_month }}. Keep up the great work taking care of your pets!
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}



    <!-- Slide 4: Enhanced Letter from Pets -->
    {% if customer_data.pet_letters %}
    <div class="slide" id="slide-3">
        <div class="slide-content letter-slide" style="background: #BDE0FE; color: #052049; overflow-y: auto; padding-top: 40px;">
            <!-- Enhanced title with decorative elements -->
            <div class="letter-slide-header" style="margin-top: 120px; margin-bottom: 40px; padding: 20px 0;">
                <div class="letter-title-container">
                    <h2 class="letter-slide-title" style="color: #052049 !important; font-size: 28px; font-weight: 800; text-align: center; margin: 0; font-family: 'Nunito', sans-serif; text-shadow: 0 2px 4px rgba(5,32,73,0.1); letter-spacing: 0.5px; position: relative; z-index: 10;">Letter from your pets</h2>
                    <div class="letter-title-decoration"></div>
                </div>
            </div>
            <!-- Letter content with proper letter formatting -->
            <div class="enhanced-letter-content" style="color: #052049; max-width: 700px; margin: 0 auto; font-size: 20px; line-height: 1.8; font-family: 'Caveat', 'Segoe Print', 'Bradley Hand', cursive; background: none; box-shadow: none; padding: 0;">
                {% if customer_data.pet_letters %}
                    {% set letter_text = customer_data.pet_letters %}
                    {% if letter_text %}
                        {% set lines = letter_text.split('\n') %}
                        {% set clean_lines = [] %}
                        {% set greeting_found = false %}
                        {% set signature_found = false %}
                        {% set body_lines = [] %}
                        {% set greeting = '' %}
                        {% set signature = '' %}
                        
                        {% for line in lines %}
                            {% if line.strip() and not line.startswith('Collective Letter from All Pets for Customer') and not line.startswith('=') %}
                                {% set clean_line = line.strip() %}
                                
                                <!-- Extract greeting -->
                                {% if not greeting_found and (clean_line.lower().startswith('dear') or clean_line.lower().startswith('hello') or clean_line.lower().startswith('hi')) %}
                                    {% set greeting = clean_line %}
                                    {% set greeting_found = true %}
                                <!-- Extract signature -->
                                {% elif clean_line.lower().startswith('from:') or clean_line.lower().startswith('with') or clean_line.lower().startswith('love') or clean_line.lower().startswith('sincerely') or clean_line.lower().startswith('your') %}
                                    {% set signature = clean_line %}
                                    {% set signature_found = true %}
                                <!-- Body content -->
                                {% else %}
                                    {% if clean_line.endswith('.') or clean_line.endswith('!') or clean_line.endswith('?') %}
                                        {% set _ = body_lines.append(clean_line) %}
                                    {% else %}
                                        {% set _ = body_lines.append(clean_line + '.') %}
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                        
                        <!-- Proper letter structure -->
                        <div class="letter-structure" style="display: flex; flex-direction: column; gap: 20px;">
                            <!-- Greeting -->
                            {% if greeting %}
                                <div class="letter-greeting" style="font-size: 22px; font-weight: 600; color: #052049; margin-bottom: 10px;">{{ greeting }}</div>
                            {% endif %}
                            
                            <!-- Body paragraphs -->
                            {% if body_lines %}
                                <div class="letter-body" style="font-size: 20px; line-height: 1.8; color: #052049; text-align: left; font-weight: 500; letter-spacing: 0.5px; margin-bottom: 20px;">
                                    {% for line in body_lines %}
                                        <div class="letter-paragraph" style="margin-bottom: 15px;">{{ line }}</div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            
                            <!-- Signature -->
                            {% if signature %}
                                <div class="letter-signature" style="font-size: 22px; font-weight: 600; color: #052049; margin-top: 20px; text-align: right;">{{ signature }}</div>
                            {% endif %}
                        </div>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Slide 4: Personality Badge -->
    {% if customer_data.badge %}
    <div class="slide" id="slide-4">
        <div class="slide-content badge-slide" style="background: #FFCAD4; color: #5A1C2E;">
            <div class="household-personality-container" style="padding: 0; gap: 20px;">
                <!-- Large bold title -->
                <h1 class="household-title" style="margin-top: 0; color: #5A1C2E;">Household Personality for Your Pets</h1>
                
                <!-- Central circular badge section -->
                <div class="central-badge-section">
                    <div class="badge-circle">
                        <img src="{{ customer_data.badge.image_path }}" alt="Personality Badge" class="central-badge-image">
                    </div>
                    <h2 class="badge-label" style="color: #5A1C2E;">{{ customer_data.badge.badge }}</h2>
            </div>
            
                <!-- Horizontal personality words -->
                <div class="personality-words-section" style="display: flex; justify-content: center; gap: 15px; margin: 20px 0;">
                    <div class="personality-word" style="background: linear-gradient(135deg, #E91E63, #C2185B); color: white; border: none; border-radius: 12px; padding: 8px 16px; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 16px rgba(233, 30, 99, 0.25); transition: all 0.3s ease; cursor: pointer;">Playful</div>
                    <div class="personality-word" style="background: linear-gradient(135deg, #E91E63, #C2185B); color: white; border: none; border-radius: 12px; padding: 8px 16px; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 16px rgba(233, 30, 99, 0.25); transition: all 0.3s ease; cursor: pointer;">Loyal</div>
                    <div class="personality-word" style="background: linear-gradient(135deg, #E91E63, #C2185B); color: white; border: none; border-radius: 12px; padding: 8px 16px; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 16px rgba(233, 30, 99, 0.25); transition: all 0.3s ease; cursor: pointer;">Gentle</div>
                </div>
                
                <!-- Compatible With section -->
                <div class="compatible-with-section">
                    <h3 class="compatible-with-title" style="color: #5A1C2E;">Compatible With</h3>
                    <div class="compatible-badges-row">
                        <div class="compatible-badge-small">
                            <img src="/static/badges/badge_athlete copy.png" alt="Athlete Badge" class="compatible-badge-small-image">
                            <span class="compatible-badge-small-name"  style="color: #5A1C2E;">Athlete</span>
                        </div>
                        <div class="compatible-badge-small">
                            <img src="/static/badges/badge_cuddler copy.png" alt="Cuddler Badge" class="compatible-badge-small-image">
                            <span class="compatible-badge-small-name"  style="color: #5A1C2E;">Cuddler</span>
                        </div>
                        <div class="compatible-badge-small">
                            <img src="/static/badges/badge_explorer copy.png" alt="Explorer Badge" class="compatible-badge-small-image">
                            <span class="compatible-badge-small-name"  style="color: #5A1C2E;">Explorer</span>
                        </div>
                </div>
            </div>
            
                <!-- Call-to-action button -->
                <div class="share-cta-section">
                    <button class="share-cta-button" onclick="shareToSocial('facebook')" style="background: linear-gradient(135deg, #E91E63, #C2185B); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 16px; font-weight: 600; font-family: 'Poppins', sans-serif; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3); display: flex; align-items: center; gap: 10px; margin: 0 auto;">
                        Share to discover your pet's friends
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Slide 5: Breed Prediction - First Display -->
    {% if customer_data.breed_prediction %}
    <div class="slide" id="slide-5">
        <div class="slide-content breed-slide" style="background: #D0F4DE; min-height: 100vh; padding: 20px 15px 80px 15px;">
            <div class="breed-container" style="margin-top: 20px; max-width: 480px; margin-left: auto; margin-right: auto;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 40px; margin-bottom: 20px; font-family: 'Nunito', 'Poppins', sans-serif; font-weight: 700; font-size: 26px; color: #1C3A2E; text-shadow: 0 2px 4px rgba(28, 58, 46, 0.1);">
                    Our Breed Predictions
                </h2>
                    
                    <!-- Pet Highlight Section -->
                    <p class="breed-highlight-text" style="text-align: center; margin-bottom: 18px; font-family: 'Poppins', sans-serif; font-size: 14px; color: #1C3A2E; font-weight: 500;">
                        We are highlighting <strong style="color: #1C3A2E; font-weight: 700;">
                            {% if customer_data.breed_prediction.multiple_predictions %}
                                {{ customer_data.breed_prediction.multiple_predictions[0].pet_name }}
                            {% elif customer_data.breed_prediction.pet_name %}
                                {{ customer_data.breed_prediction.pet_name }}
                            {% else %}
                                your pet
                            {% endif %}
                        </strong>
                    </p>
                    
                    <!-- Simple Breed Predictions -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 8px; margin-bottom: 20px;">
                        {% if customer_data.breed_prediction.multiple_predictions %}
                            {% set first_prediction = customer_data.breed_prediction.multiple_predictions[0] %}
                            {% if first_prediction.prediction and first_prediction.prediction.breed_distribution %}
                                {% for breed_name, percentage in first_prediction.prediction.breed_distribution.items() %}
                                <div onclick="handleBreedCardClick(event)" data-breed="{{ breed_name }}" data-pet="{{ first_prediction.pet_name }}" data-confidence="{{ percentage }}" data-explanation="{{ first_prediction.prediction.explanations[breed_name] if first_prediction.prediction.explanations and breed_name in first_prediction.prediction.explanations else 'No explanation available' }}" style="background: rgba(255, 255, 255, 0.9); border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; border: 1px solid rgba(16, 185, 129, 0.2);">
                                    <div style="color: #1C3A2E; font-size: 12px; font-weight: 600; margin-bottom: 4px; text-transform: capitalize;">{{ breed_name | format_breed_name_simple }}</div>
                                    <div style="color: #10B981; font-size: 14px; font-weight: 700;">{{ "%.0f"|format(percentage) }}%</div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div onclick="handleBreedCardClick(event)" data-breed="{{ first_prediction.predicted_breed }}" data-pet="{{ first_prediction.pet_name }}" data-confidence="100" data-explanation="No explanation available" style="background: rgba(255, 255, 255, 0.9); border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; border: 1px solid rgba(16, 185, 129, 0.2);">
                                    <div style="color: #1C3A2E; font-size: 12px; font-weight: 600; margin-bottom: 4px; text-transform: capitalize;">{{ first_prediction.predicted_breed }}</div>
                                    <div style="color: #10B981; font-size: 14px; font-weight: 700;">100%</div>
                                </div>
                            {% endif %}
                        {% elif customer_data.breed_prediction.prediction %}
                            {% if customer_data.breed_prediction.prediction.breed_distribution %}
                                {% for breed_name, percentage in customer_data.breed_prediction.prediction.breed_distribution.items() %}
                                <div onclick="handleBreedCardClick(event)" data-breed="{{ breed_name }}" data-pet="{{ customer_data.breed_prediction.pet_name }}" data-confidence="{{ percentage }}" data-explanation="{{ customer_data.breed_prediction.prediction.explanations[breed_name] if customer_data.breed_prediction.prediction.explanations and breed_name in customer_data.breed_prediction.prediction.explanations else 'No explanation available' }}" style="background: rgba(255, 255, 255, 0.9); border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; border: 1px solid rgba(16, 185, 129, 0.2);">
                                    <div style="color: #1C3A2E; font-size: 12px; font-weight: 600; margin-bottom: 4px; text-transform: capitalize;">{{ breed_name | format_breed_name_simple }}</div>
                                    <div style="color: #10B981; font-size: 14px; font-weight: 700;">{{ "%.0f"|format(percentage) }}%</div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div onclick="handleBreedCardClick(event)" data-breed="{{ customer_data.breed_prediction.predicted_breed }}" data-pet="{{ customer_data.breed_prediction.pet_name }}" data-confidence="100" data-explanation="No explanation available" style="background: rgba(255, 255, 255, 0.9); border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; border: 1px solid rgba(16, 185, 129, 0.2);">
                                    <div style="color: #1C3A2E; font-size: 12px; font-weight: 600; margin-bottom: 4px; text-transform: capitalize;">{{ customer_data.breed_prediction.predicted_breed }}</div>
                                    <div style="color: #10B981; font-size: 14px; font-weight: 700;">100%</div>
                                </div>
                            {% endif %}
                        {% else %}
                            <div onclick="handleBreedCardClick(event)" data-breed="{{ customer_data.breed_prediction.predicted_breed }}" data-pet="Unknown" data-confidence="100" data-explanation="No explanation available" style="background: rgba(255, 255, 255, 0.9); border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; border: 1px solid rgba(16, 185, 129, 0.2);">
                                <div style="color: #1C3A2E; font-size: 12px; font-weight: 600; margin-bottom: 4px; text-transform: capitalize;">{{ customer_data.breed_prediction.predicted_breed }}</div>
                                <div style="color: #10B981; font-size: 14px; font-weight: 700;">100%</div>
                            </div>
                        {% endif %}
                    </div>
                    
                    <!-- Step 2: Question -->
                    <div class="breed-question-section" id="breed-question-section" style="display: block; text-align: center; margin-top: 20px; padding: 24px 20px; background: linear-gradient(135deg, rgba(255, 255, 255, 0.98) 0%, rgba(248, 250, 252, 0.98) 100%); border-radius: 24px; box-shadow: 0 12px 40px rgba(28, 58, 46, 0.12); border: 2px solid rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); position: relative; overflow: hidden;">
                        <!-- Decorative background elements -->
                        <div style="position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: radial-gradient(circle at 30% 70%, rgba(28, 58, 46, 0.03) 0%, transparent 50%), radial-gradient(circle at 70% 30%, rgba(44, 95, 139, 0.02) 0%, transparent 50%); pointer-events: none;"></div>
                        
                        <!-- Question Icon -->
                        <div style="margin-bottom: 16px; position: relative; z-index: 2;">
                            <div style="width: 48px; height: 48px; background: linear-gradient(135deg, #10B981, #059669); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 12px; box-shadow: 0 4px 16px rgba(16, 185, 129, 0.3);">
                                <span style="font-size: 20px; color: white;">🤔</span>
                            </div>
                        </div>
                        
                        <!-- Question Content -->
                        <div style="margin-bottom: 20px; position: relative; z-index: 2;">
                            <h4 class="breed-question-title" style="color: #1C3A2E; font-size: 22px; font-weight: 700; margin: 0 0 6px 0; font-family: 'Poppins', sans-serif; letter-spacing: -0.3px;">Did we get any right?</h4>
                            <p style="color: #6B7280; font-size: 15px; margin: 0; font-family: 'Poppins', sans-serif; font-weight: 500; line-height: 1.5; opacity: 0.8;">Help us improve our predictions</p>
                        </div>
                        
                        <!-- Enhanced Buttons -->
                        <div class="breed-question-buttons" style="display: flex; justify-content: center; gap: 8px; position: relative; z-index: 2;">
                            <button class="breed-question-btn breed-yes-btn" onclick="handleBreedYes()" style="background: linear-gradient(135deg, #10B981, #059669); color: white; border: none; border-radius: 12px; padding: 8px 16px; cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; align-items: center; gap: 6px; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3); min-width: 80px; position: relative; overflow: hidden;">
                                <span class="breed-btn-emoji" style="font-size: 14px; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">✅</span>
                                <span class="breed-btn-text">Yes</span>
                                <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s ease;"></div>
                            </button>
                            <button class="breed-question-btn breed-no-btn" onclick="handleBreedNo()" style="background: linear-gradient(135deg, #EF4444, #DC2626); color: white; border: none; border-radius: 12px; padding: 8px 16px; cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); display: flex; align-items: center; gap: 6px; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3); min-width: 80px; position: relative; overflow: hidden;">
                                <span class="breed-btn-emoji" style="font-size: 14px; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.1));">❌</span>
                                <span class="breed-btn-text">No</span>
                                <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s ease;"></div>
                            </button>
                        </div>
                        
                        <!-- Subtle border accent -->
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, #10B981, #059669, #EF4444, #DC2626); border-radius: 24px 24px 0 0;"></div>
                    </div>
                    
                    <!-- Step 3: No Response -->
                    <div class="breed-no-response" id="breed-no-response" style="display: none; text-align: center; margin-top: 20px; padding: 24px 20px; background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%); border-radius: 18px; box-shadow: 0 8px 32px rgba(44, 95, 139, 0.08); border: 1px solid rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px);">
                        <div class="breed-no-content">
                            <div style="margin-bottom: 20px;">
                                <h4 class="breed-no-title" style="color: #2C5F8B; font-size: 20px; font-weight: 700; margin: 0 0 8px 0; font-family: 'Poppins', sans-serif; letter-spacing: -0.5px;">We thought we had it 😢</h4>
                                <p class="breed-no-message" style="color: #6B7280; font-size: 14px; margin: 0; font-family: 'Poppins', sans-serif; font-weight: 400; line-height: 1.4;">Help us improve our predictions by completing your pet profiles</p>
                            </div>
                            <div class="breed-profile-link-section">
                                <a href="https://www.chewy.com/account/profile" target="_blank" class="breed-profile-link" style="background: linear-gradient(135deg, #E91E63, #C2185B); color: white; text-decoration: none; padding: 12px 24px; border-radius: 12px; font-size: 15px; font-weight: 600; font-family: 'Poppins', sans-serif; display: inline-block; transition: all 0.3s ease; box-shadow: 0 4px 16px rgba(233, 30, 99, 0.25);">
                                    Complete Pet Profile
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Breed Flashcard Modal -->
                <div class="breed-flashcard-modal" id="breed-flashcard-modal">
                    <div class="breed-flashcard-content">
                        <div class="breed-flashcard-header">
                            <h3 id="flashcard-breed-name">Breed Name</h3>
                            <button class="breed-flashcard-close" onclick="closeBreedFlashcard()">×</button>
                        </div>
                        <div class="breed-flashcard-body">
                            <div class="breed-flashcard-description" id="flashcard-description">
                                <p>Loading breed information...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>
    {% endif %}



    <!-- Slide 6: Social Media Share -->
    <div class="slide" id="slide-6">
        <div class="slide-content share-slide" style="min-height: 100vh; padding: 75px 15px 80px 15px; background: #FFE181; color: #3C3C3C;">
            <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 40px; font-family: 'Baloo 2', sans-serif; font-weight: 700; font-size: 28px; color: #3C3C3C;">
                    Share Your Chewy Journey!
                </h2>
            </div>
            
            <div class="enhanced-share-text">
                <p style="color: #4A1A1A; font-size: 18px; margin-bottom: 25px; opacity: 0.9; font-weight: 600;">
                    Tap to select which features you'd like to share:
                </p>
            </div>
            
            <div class="feature-selection-grid" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 18px; margin: 35px 0; max-width: 550px; margin-left: auto; margin-right: auto;">
                <div class="feature-card" data-feature="food" onclick="toggleFeature('food')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px 15px; border-radius: 16px; cursor: pointer; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.25); border: 2px solid rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); position: relative; overflow: hidden; min-height: 100px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                    <div class="feature-icon" style="font-size: 28px; margin-bottom: 10px; color: #4A1A1A;">🍽️</div>
                    <div class="feature-label" style="font-size: 13px; font-weight: 600; color: #3C3C3C; text-align: center; margin-bottom: 6px; font-family: 'Nunito', sans-serif;">Food Consumed</div>
                    <div class="feature-value" id="food-share-value" style="font-size: 12px; color: #4A1A1A; text-align: center; font-family: 'Nunito', sans-serif; font-weight: 500;">{{ customer_data.total_food_consumed|default('', true) }}</div>
                </div>
                
                <div class="feature-card" data-feature="portrait" onclick="toggleFeature('portrait')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px 15px; border-radius: 16px; cursor: pointer; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.25); border: 2px solid rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); position: relative; overflow: hidden; min-height: 100px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                    <div class="feature-icon" style="font-size: 28px; margin-bottom: 10px; color: #4A1A1A;">🎨</div>
                    <div class="feature-label" style="font-size: 13px; font-weight: 600; color: #3C3C3C; text-align: center; margin-bottom: 6px; font-family: 'Nunito', sans-serif;">AI Pet Portrait</div>
                    <div class="feature-value" style="font-size: 12px; color: #4A1A1A; text-align: center; font-family: 'Nunito', sans-serif; font-weight: 500;">Generated</div>
                </div>
                
                <div class="feature-card" data-feature="letter" onclick="toggleFeature('letter')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px 15px; border-radius: 16px; cursor: pointer; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.25); border: 2px solid rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); position: relative; overflow: hidden; min-height: 100px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                    <div class="feature-icon" style="font-size: 28px; margin-bottom: 10px; color: #4A1A1A;">💌</div>
                    <div class="feature-label" style="font-size: 13px; font-weight: 600; color: #3C3C3C; text-align: center; margin-bottom: 6px; font-family: 'Nunito', sans-serif;">Letter from Pets</div>
                    <div class="feature-value" style="font-size: 12px; color: #4A1A1A; text-align: center; font-family: 'Nunito', sans-serif; font-weight: 500;">Personalized</div>
                </div>
                
                <div class="feature-card" data-feature="breed" onclick="toggleFeature('breed')" style="display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px 15px; border-radius: 16px; cursor: pointer; transition: all 0.3s ease; background: rgba(255, 255, 255, 0.25); border: 2px solid rgba(255, 255, 255, 0.3); backdrop-filter: blur(10px); position: relative; overflow: hidden; min-height: 100px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);">
                    <div class="feature-icon" style="font-size: 28px; margin-bottom: 10px; color: #4A1A1A;">🐕</div>
                    <div class="feature-label" style="font-size: 13px; font-weight: 600; color: #3C3C3C; text-align: center; margin-bottom: 6px; font-family: 'Nunito', sans-serif;">Breed Prediction</div>
                    <div class="feature-value" style="font-size: 12px; color: #4A1A1A; text-align: center; font-family: 'Nunito', sans-serif; font-weight: 500;">AI Analysis</div>
                </div>
            </div>
            
            <div class="enhanced-share-cta" style="text-align: center; margin-top: 30px;">
                <button class="enhanced-share-btn" onclick="showIOSShareSheet()" style="background: linear-gradient(135deg, #FFD700, #FFA500); color: #3C3C3C; border: none; border-radius: 20px; padding: 16px 32px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 16px; font-weight: 700; font-family: 'Poppins', sans-serif; box-shadow: 0 6px 20px rgba(255, 215, 0, 0.3); position: relative; overflow: hidden;">
                    <!-- <span style="font-size: 18px;">📤</span> -->
                    <span class="enhanced-share-text">Share Your Journey</span>
                    <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); transition: left 0.5s ease;"></div>
                </button>
            </div>
            
            <div class="slide-counter" style="background: rgba(60, 60, 60, 0.9); color: white; padding: 8px 15px; border-radius: 15px; font-size: 12px; font-weight: 600; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3);">7 of 8</div>
        </div>
    </div>

    <!-- iOS-Style Share Sheet -->
    <div id="ios-share-overlay" class="ios-share-overlay">
        <div class="ios-share-sheet">
            <!-- Share Options Section -->
            <div class="share-options-section">
                <div class="share-apps-grid">
                    <!-- Instagram -->
                    <div class="share-app-item" onclick="shareToApp('instagram')">
                        <div class="share-app-icon instagram-icon">
                            <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                                <defs>
                                    <linearGradient id="instagram-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#f9ce34"/>
                                        <stop offset="33%" style="stop-color:#ee2a7b"/>
                                        <stop offset="66%" style="stop-color:#6228d7"/>
                                    </linearGradient>
                                </defs>
                                <rect width="60" height="60" rx="18" fill="url(#instagram-gradient)"/>
                                <rect x="18" y="18" width="24" height="24" rx="8" fill="none" stroke="white" stroke-width="2"/>
                                <circle cx="30" cy="30" r="6" fill="none" stroke="white" stroke-width="2"/>
                                <circle cx="36" cy="24" r="2" fill="white"/>
                            </svg>
                        </div>
                        <span class="share-app-label">Instagram</span>
                    </div>

                    <!-- Messages -->
                    <div class="share-app-item" onclick="shareToApp('messages')">
                        <div class="share-app-icon messages-icon">
                            <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                                <rect width="60" height="60" rx="18" fill="#00d4aa"/>
                                <path d="M30 18c-7.732 0-14 5.641-14 12.6 0 4.054 2.323 7.637 5.95 10.05-.369 3.85-2.745 6.35-2.745 6.35s4.523-.735 7.295-3.5c1.13.31 2.34.47 3.5.47 7.732 0 14-5.641 14-12.6S37.732 18 30 18z" fill="white"/>
                            </svg>
                        </div>
                        <span class="share-app-label">Messages</span>
                    </div>

                    <!-- WhatsApp -->
                    <div class="share-app-item" onclick="shareToApp('whatsapp')">
                        <div class="share-app-icon whatsapp-icon">
                            <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                                <rect width="60" height="60" rx="18" fill="#25d366"/>
                                <path d="M30 15c-8.284 0-15 6.716-15 15 0 2.567.667 5.133 1.933 7.367L15 45l7.633-1.933A14.93 14.93 0 0 0 30 45c8.284 0 15-6.716 15-15s-6.716-15-15-15zm7.5 21.5c-.333.933-1.667 1.7-2.767 1.933-.733.167-1.7.3-4.933-.85-3.9-1.4-6.433-5.267-6.633-5.517-.2-.25-1.667-2.2-1.667-4.2s1.067-3.867 1.433-4.4c.367-.533.8-.667 1.067-.667.267 0 .533 0 .767.017.25.017.583-.1.917.7.333.8 1.15 2.8 1.25 3 .1.2.167.433.033.7-.133.267-.2.433-.4.667-.2.233-.417.517-.6.7-.2.2-.417.417-.183.817.233.4.983 1.583 2.117 2.567 1.45 1.267 2.667 1.65 3.05 1.85.383.2.6.167.817-.1.217-.267.933-1.083 1.183-1.467.25-.383.5-.317.833-.183.333.133 2.133 1 2.5 1.183.367.183.617.283.717.433.1.15.1.883-.233 1.817z" fill="white"/>
                            </svg>
                        </div>
                        <span class="share-app-label">WhatsApp</span>
                    </div>

                    <!-- Facebook -->
                    <div class="share-app-item" onclick="shareToApp('facebook')">
                        <div class="share-app-icon facebook-icon">
                            <svg width="60" height="60" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
                                <rect width="60" height="60" rx="18" fill="#1877f2"/>
                                <path d="M35 31l1.5-9H28v-6c0-2.5 1.2-4.9 5.1-4.9H37V4.4s-3.6-.6-7-.6c-7.1 0-11.7 4.3-11.7 12.1V22h-8v9h8v22h9.9V31H35z" fill="white"/>
                            </svg>
                        </div>
                        <span class="share-app-label">Facebook</span>
                    </div>
                </div>
            </div>

            <!-- Action Buttons Section -->
            <div class="share-actions-section">
                <div class="share-action-item" onclick="copyShareLink()">
                    <div class="share-action-icon">
                        <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M16 3H8C6.34 3 5 4.34 5 6v12c0 1.66 1.34 3 3 3h8c1.66 0 3-1.34 3-3V6c0-1.66-1.34-3-3-3zm-1 16H10v-2h5v2zm0-4H10v-2h5v2zm0-4H10V9h5v2z" fill="#007AFF"/>
                        </svg>
                    </div>
                    <div class="share-action-text">
                        <div class="share-action-title">Copy Link</div>
                    </div>
                </div>

                <div class="share-action-item" onclick="saveToPhotos()">
                    <div class="share-action-icon">
                        <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z" fill="#007AFF"/>
                        </svg>
                    </div>
                    <div class="share-action-text">
                        <div class="share-action-title">Save to Photos</div>
                    </div>
                </div>
            </div>

            <!-- Cancel Button -->
            <div class="share-cancel-section">
                <button class="share-cancel-btn" onclick="hideIOSShareSheet()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Slide 7: Your Chewy Stats -->
    <div class="slide" id="slide-7">
        <div class="slide-content stats-slide" style="overflow-y: auto; min-height: 100vh; padding: 20px 15px 80px 15px; background: #F0E8F8;">
            <div class="slide-header" style="text-align: center; margin-bottom: 40px; margin-top: 400px;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 80px; font-family: 'Nunito', 'Poppins', sans-serif; font-weight: 700; font-size: 32px; color: #87CEEB; text-shadow: 0 2px 4px rgba(135, 206, 235, 0.1);">
                    Your Chewy Stats
                </h2>
            </div>
            
            <div class="enhanced-stats-container" style="max-width: 500px; margin: 0 auto; padding: 0 15px;">
                <div class="stats-grid" style="display: flex; flex-direction: column; gap: 15px; margin-bottom: 20px;">
                    
                    {% if customer_data.total_months and customer_data.total_months > 0 %}
                    <div class="stat-card-pastel" style="background: #E8F4F8; border-radius: 16px; padding: 20px 15px; text-align: center; box-shadow: 0 6px 20px rgba(232, 244, 248, 0.3); border: 2px solid rgba(255, 255, 255, 0.8); animation: fadeInScale 0.6s ease-out 0.1s both; opacity: 0; transform: scale(0.9); position: relative; overflow: hidden; transition: all 0.3s ease;">
                        <div class="stat-icon" style="font-size: 28px; margin-bottom: 10px; color: #5A8BA8;">📅</div>
                        <div class="stat-value" style="color: #3C3C3C; font-size: 28px; font-weight: 800; margin-bottom: 6px; font-family: 'Poppins', sans-serif;">{{ customer_data.total_months }}</div>
                        <div class="stat-label" style="color: #4A1A1A; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif;">Months with Chewy</div>
                    </div>
                    {% endif %}
                    
                    {% if customer_data.autoship_savings and customer_data.autoship_savings > 0 %}
                    <div class="stat-card-pastel" style="background: #F0F8E8; border-radius: 16px; padding: 20px 15px; text-align: center; box-shadow: 0 6px 20px rgba(240, 248, 232, 0.3); border: 2px solid rgba(255, 255, 255, 0.8); animation: fadeInScale 0.6s ease-out 0.2s both; opacity: 0; transform: scale(0.9); position: relative; overflow: hidden; transition: all 0.3s ease;">
                        <div class="stat-icon" style="font-size: 28px; margin-bottom: 10px; color: #7A9A6A;">💰</div>
                        <div class="stat-value" style="color: #3C3C3C; font-size: 28px; font-weight: 800; margin-bottom: 6px; font-family: 'Poppins', sans-serif;">${{ "%.2f"|format(customer_data.autoship_savings) }}</div>
                        <div class="stat-label" style="color: #4A1A1A; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif;">Autoship Savings</div>
                    </div>
                    {% endif %}
                    
                    {% if customer_data.cuddliest_month and customer_data.cuddliest_month != "N/A" and customer_data.cuddliest_month != "" %}
                    <div class="stat-card-pastel" style="background: #F8E8F0; border-radius: 16px; padding: 20px 15px; text-align: center; box-shadow: 0 6px 20px rgba(248, 232, 240, 0.3); border: 2px solid rgba(255, 255, 255, 0.8); animation: fadeInScale 0.6s ease-out 0.3s both; opacity: 0; transform: scale(0.9); position: relative; overflow: hidden; transition: all 0.3s ease;">
                        <div class="stat-icon" style="font-size: 28px; margin-bottom: 10px; color: #A87A9A;">🎯</div>
                        <div class="stat-value" style="color: #3C3C3C; font-size: 22px; font-weight: 800; margin-bottom: 6px; font-family: 'Poppins', sans-serif; line-height: 1.2;">{{ customer_data.cuddliest_month }}</div>
                        <div class="stat-label" style="color: #4A1A1A; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif;">Your Pet's Favorite Month</div>
                        <div class="stat-subtitle" style="color: #A87A9A; font-size: 12px; font-weight: 400; margin-top: 3px; font-family: 'Poppins', sans-serif;">Most Orders!</div>
                    </div>
                    {% endif %}
                    
                    {% if customer_data.amount_donated and customer_data.amount_donated > 0 %}
                    <div class="stat-card-pastel" style="background: #F8E8E8; border-radius: 16px; padding: 20px 15px; text-align: center; box-shadow: 0 6px 20px rgba(248, 232, 232, 0.3); border: 2px solid rgba(255, 255, 255, 0.8); animation: fadeInScale 0.6s ease-out 0.4s both; opacity: 0; transform: scale(0.9); position: relative; overflow: hidden; transition: all 0.3s ease;">
                        <div class="stat-icon" style="font-size: 28px; margin-bottom: 10px; color: #A87A7A;">❤️</div>
                        <div class="stat-value" style="color: #3C3C3C; font-size: 28px; font-weight: 800; margin-bottom: 6px; font-family: 'Poppins', sans-serif;">${{ "%.2f"|format(customer_data.amount_donated) }}</div>
                        <div class="stat-label" style="color: #4A1A1A; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif;">Amount Donated</div>
                    </div>
                    {% endif %}
                    
                    {% if customer_data.most_ordered and customer_data.most_ordered != "N/A" and customer_data.most_ordered != "" %}
                    <div class="stat-card-pastel" style="background: #E8F0F8; border-radius: 16px; padding: 20px 15px; text-align: center; box-shadow: 0 6px 20px rgba(232, 240, 248, 0.3); border: 2px solid rgba(255, 255, 255, 0.8); animation: fadeInScale 0.6s ease-out 0.5s both; opacity: 0; transform: scale(0.9); position: relative; overflow: hidden; transition: all 0.3s ease;">
                        <div class="stat-icon" style="font-size: 28px; margin-bottom: 10px; color: #7A9AA8;">🛒</div>
                        <div class="stat-value" style="color: #3C3C3C; font-size: 18px; font-weight: 800; margin-bottom: 6px; font-family: 'Poppins', sans-serif; line-height: 1.3;">{{ customer_data.most_ordered }}</div>
                        <div class="stat-label" style="color: #4A1A1A; font-size: 14px; font-weight: 600; font-family: 'Poppins', sans-serif;">Most Ordered</div>
                    </div>
                    {% endif %}
                    
                </div>
            </div>
        </div>
    </div>

    <!-- Slide 8: Missing Pet Profile Information -->
    {% if customer_data.unknowns %}
    <div class="slide" id="slide-8">
        <div class="slide-content unknowns-slide" style="overflow-y: auto; min-height: 100vh; padding: 40px 20px 80px 20px; background: #D0F4DE;">
            <div class="slide-header" style="text-align: center; margin-bottom: 40px;">
                <h2 class="slide-title" style="text-align: center; margin: 0; margin-top: 40px; font-family: 'Nunito', 'Poppins', sans-serif; font-weight: 700; font-size: 28px; color: #3C3C3C;">
                    Complete Your Pet Profiles
                </h2>
                <!-- <p style="color: #4A1A1A; font-size: 16px; margin-top: 12px; opacity: 0.8; font-weight: 500;">
                    Get even more personalized insights!
                </p> -->
            </div>
            
            <div class="unknowns-container" style="max-width: 600px; margin: 0 auto;">
                <div class="unknowns-summary" style="text-align: center; margin-bottom: 30px; padding: 20px; background: rgba(255, 255, 255, 0.3); border-radius: 16px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2);">
                    <p style="color: #3C3C3C; font-size: 16px; margin: 0; font-weight: 600; line-height: 1.5;">
                        We found <strong>{{ customer_data.unknowns.total_unknowns }}</strong> missing pieces of information across <strong>{{ customer_data.unknowns.pets_with_unknowns }}</strong> pet(s).
                    </p>
                </div>
                
                <div class="unknowns-pets-grid" style="display: flex; flex-direction: column; gap: 20px;">
                    {% for pet_name, pet_data in customer_data.unknowns.unknown_attributes.items() %}
                    <div class="unknowns-pet-card" style="background: rgba(255, 255, 255, 0.4); padding: 24px; border-radius: 16px; backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3); transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);">
                        <div class="unknowns-pet-name" style="color: #3C3C3C; font-size: 20px; font-weight: 700; margin-bottom: 16px; text-align: center; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            {{ pet_data.pet_name | title }}
                        </div>
                        <div class="unknowns-fields-container" style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                            {% for field in pet_data.unknown_fields %}
                            <a href="https://www.chewy.com/account/profile" target="_blank" style="background: #A0E7E5; color: #3C3C3C; padding: 8px 16px; border-radius: 20px; font-size: 13px; font-weight: 600; text-decoration: none; transition: all 0.3s ease; border: 1px solid rgba(255, 255, 255, 0.3); box-shadow: 0 2px 8px rgba(160, 231, 229, 0.3);">
                                {{ field.replace('_', ' ').title() }}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <a href="https://www.chewy.com/account/profile" target="_blank" style="display: inline-flex; align-items: center; gap: 10px; padding: 14px 28px; background: #A0E7E5; color: #3C3C3C; text-decoration: none; border-radius: 12px; font-size: 16px; font-weight: 600; font-family: 'Poppins', sans-serif; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(160, 231, 229, 0.3); border: 1px solid rgba(255, 255, 255, 0.3);">
                        <span style="font-size: 16px;">⚙️</span>
                        Complete Profiles
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}


            
</div>

<script>
let currentSlide = 0;
let totalSlides = 0;
let isTransitioning = false;
let progressChunks = [];
let slideToChunkMapping = {};

// Initialize slides
document.addEventListener('DOMContentLoaded', function() {
    // Count total slides
    const allSlides = document.querySelectorAll('.slide');
    totalSlides = allSlides.length;
    
    // Debug: Log all slides
    console.log(`📊 Total slides: ${totalSlides}, All slides: ${allSlides.length}`);
    allSlides.forEach((slide, index) => {
        console.log(`📋 Slide ${index}: ${slide.id} - visible: ${slide.style.display !== 'none'}`);
    });
    
    // Determine which slides have data
    const slidesWithData = [];
    for (let i = 0; i < totalSlides; i++) {
        const slide = document.getElementById(`slide-${i}`);
        if (slide && slide.style.display !== 'none') {
            slidesWithData.push(i);
        }
    }
    
    // Create progress bar based on available slides
    createProgressBar(slidesWithData);
    
    // Initialize arrow navigation
    updateArrowNavigation();
    
    // Initialize breed prediction slide
    initializeBreedPredictionSlide();
    
    // Show loading slide first, then transition to first real slide after a delay
    console.log(`🚀 Showing loading slide...`);
    showSlide(0);
    
    // Auto-transition from loading to first real slide after 3 seconds
    setTimeout(() => {
        console.log(`🔄 Auto-transitioning from loading to first slide...`);
        showSlide(1);
    }, 3000);
});

function showSlide(slideIndex) {
    console.log(`🎯 showSlide(${slideIndex}) called, currentSlide=${currentSlide}, isTransitioning=${isTransitioning}`);
    
    if (isTransitioning || slideIndex === currentSlide) {
        console.log(`⏸️ Skipping slide change - transitioning: ${isTransitioning}, same slide: ${slideIndex === currentSlide}`);
        return;
    }
    
    isTransitioning = true;
    
    // Hide all slides
    const visibleSlides = Array.from(document.querySelectorAll('.slide'));
    console.log(`📋 Found ${visibleSlides.length} slides total`);
    visibleSlides.forEach((slide, index) => {
        slide.classList.remove('active');
        console.log(`👁️ Slide ${index} (${slide.id}): removed active class`);
    });
    
    // Show target slide
    if (visibleSlides[slideIndex]) {
        visibleSlides[slideIndex].classList.add('active');
        currentSlide = slideIndex;
        console.log(`✅ Activated slide ${slideIndex} (${visibleSlides[slideIndex].id})`);
        
        // Reset breed prediction state when navigating to breed slide
        if (slideIndex === 5) { // Breed prediction slide
            resetBreedPredictionState();
        }
        
        // Update arrow navigation states
        updateArrowNavigation();
        
        // Update progress bar
        updateProgressBar(slideIndex);
    } else {
        console.log(`❌ Slide ${slideIndex} not found!`);
    }
    
    setTimeout(() => {
        isTransitioning = false;
        console.log(`🔄 Transition complete`);
    }, 300);
}

function updateArrowNavigation() {
    const prevArrow = document.getElementById('prev-arrow');
    const nextArrow = document.getElementById('next-arrow');
    
    // Disable prev arrow on first slide
    if (currentSlide <= 0) {
        prevArrow.disabled = true;
        prevArrow.style.opacity = '0.3';
    } else {
        prevArrow.disabled = false;
        prevArrow.style.opacity = '1';
    }
    
    // Disable next arrow on last slide
    if (currentSlide >= totalSlides) {
        nextArrow.disabled = true;
        nextArrow.style.opacity = '0.3';
    } else {
        nextArrow.disabled = false;
        nextArrow.style.opacity = '1';
    }
    
    console.log(`🎯 Arrow navigation updated - currentSlide: ${currentSlide}, totalSlides: ${totalSlides}`);
}

// Progress Bar Functions
function createProgressBar(slidesWithData) {
    const progressContainer = document.getElementById('progress-bar-container');
    progressContainer.innerHTML = ''; // Clear existing chunks
    progressChunks = [];
    slideToChunkMapping = {};
    
                // Define slide groups and their chunk mapping
            const slideGroups = [
                { name: 'food', slides: [1], hasMultipleSlides: false },
                { name: 'portrait', slides: [2], hasMultipleSlides: false },
                { name: 'busiest', slides: [3], hasMultipleSlides: false },
                { name: 'letter', slides: [4], hasMultipleSlides: false },
                { name: 'breed', slides: [5], hasMultipleSlides: false },
                { name: 'share', slides: [6], hasMultipleSlides: false },
                { name: 'stats', slides: [7], hasMultipleSlides: false },
                { name: 'unknowns', slides: [8], hasMultipleSlides: false }
            ];
    
    let chunkIndex = 0;
    slideGroups.forEach(group => {
        // Check if any slide in this group has data
        const hasData = group.slides.some(slideNum => slidesWithData.includes(slideNum));
        
        if (hasData) {
            // Create chunk for this group
            const chunk = document.createElement('div');
            chunk.className = 'progress-chunk';
            chunk.innerHTML = '<div class="progress-chunk-fill"></div>';
            progressContainer.appendChild(chunk);
            
            progressChunks.push({
                element: chunk,
                fillElement: chunk.querySelector('.progress-chunk-fill'),
                hasMultipleSlides: group.hasMultipleSlides,
                slides: group.slides.filter(slideNum => slidesWithData.includes(slideNum))
            });
            
            // Map each slide to its chunk
            group.slides.forEach(slideNum => {
                if (slidesWithData.includes(slideNum)) {
                    slideToChunkMapping[slideNum] = chunkIndex;
                }
            });
            
            chunkIndex++;
        }
    });
    
    console.log('📊 Progress bar created with', progressChunks.length, 'chunks');
    console.log('📊 Slide to chunk mapping:', slideToChunkMapping);
}

function updateProgressBar(currentSlideIndex) {
    if (progressChunks.length === 0) return;
    
    const chunkIndex = slideToChunkMapping[currentSlideIndex];
    if (chunkIndex === undefined) return;
    
    // Update all chunks
    progressChunks.forEach((chunk, index) => {
        const fillElement = chunk.fillElement;
        
        if (index < chunkIndex) {
            // Completed chunks
            fillElement.style.width = '100%';
        } else if (index === chunkIndex) {
            // Current chunk
            if (chunk.hasMultipleSlides) {
                // For multi-slide chunks, show 50% or 100% based on which slide
                const slidePosition = chunk.slides.indexOf(currentSlideIndex);
                const progress = ((slidePosition + 1) / chunk.slides.length) * 100;
                fillElement.style.width = `${progress}%`;
            } else {
                // Single slide chunks show 100% when active
                fillElement.style.width = '100%';
            }
        } else {
            // Future chunks
            fillElement.style.width = '0%';
        }
    });
    
    console.log('📊 Progress updated for slide', currentSlideIndex, 'chunk', chunkIndex);
}

function nextSlide() {
    console.log(`🔄 Next: currentSlide=${currentSlide}, totalSlides=${totalSlides}`);
    if (currentSlide < totalSlides) {
        showSlide(currentSlide + 1);
    }
}

function prevSlide() {
    console.log(`🔄 Prev: currentSlide=${currentSlide}, totalSlides=${totalSlides}`);
    if (currentSlide > 1) {
        showSlide(currentSlide - 1);
    }
}

function goHome() {
    window.location.href = '/';
}

// Keyboard navigation
document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowRight' || e.key === ' ') {
        e.preventDefault();
        nextSlide();
    } else if (e.key === 'ArrowLeft') {
        e.preventDefault();
        prevSlide();
    } else if (e.key === 'Escape') {
        goHome();
    }
});

// Touch/swipe support for mobile
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener('touchstart', function(e) {
    touchStartX = e.changedTouches[0].screenX;
});

document.addEventListener('touchend', function(e) {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
});

function handleSwipe() {
    const swipeThreshold = 50;
    const diff = touchStartX - touchEndX;
    
    if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0) {
            // Swiped left - next slide
            nextSlide();
        } else {
            // Swiped right - previous slide
            prevSlide();
        }
    }
}



// Breed Prediction Interactive and Gamified Functions
let checkedBreeds = 0;
let totalBreeds = 0;
let isCardFlipped = false;

// Initialize breed count and event listeners
document.addEventListener('DOMContentLoaded', function() {
    const breedCheckboxes = document.querySelectorAll('.breed-checkbox');
    totalBreeds = breedCheckboxes.length;
    
    // Add event listeners for breed checkboxes
    breedCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
            handleBreedCheck(this);
        });
    });
    
    // Add event listener for card flip
    const flipCard = document.getElementById('breed-flip-card');
    if (flipCard) {
        flipCard.addEventListener('click', function() {
            flipBreedCard();
        });
    }
});

function handleBreedCheck(checkbox) {
    if (checkbox.checked) {
        checkedBreeds++;
        // Add visual feedback
        checkbox.parentElement.style.background = 'rgba(76, 175, 80, 0.2)';
        checkbox.parentElement.style.border = '1px solid #4CAF50';
        } else {
        checkedBreeds--;
        // Remove visual feedback
        checkbox.parentElement.style.background = 'rgba(255, 255, 255, 0.1)';
        checkbox.parentElement.style.border = '1px solid rgba(255, 255, 255, 0.2)';
    }
    
    // Show question after all breeds are checked
    if (checkedBreeds === totalBreeds) {
        setTimeout(() => {
            showAccuracyQuestion();
        }, 500);
    }
}

function showAccuracyQuestion() {
    const questionCard = document.getElementById('breed-question-card');
    questionCard.style.display = 'block';
    questionCard.style.animation = 'fadeInUp 0.8s ease-out';
    
    // Add gamification feedback
    const predictionsCard = document.getElementById('breed-predictions-card');
    predictionsCard.style.background = 'rgba(76, 175, 80, 0.1)';
    predictionsCard.style.border = '1px solid #4CAF50';
}

function handleBreedYes() {
    // Show checkboxes on all breed cards
    const breedCards = document.querySelectorAll('.breed-card');
    breedCards.forEach(card => {
        const checkbox = card.querySelector('.breed-card-checkbox');
        if (checkbox) {
            checkbox.style.display = 'block';
        }
    });
    
    // Hide the question section
    const questionSection = document.getElementById('breed-question-section');
    if (questionSection) {
        questionSection.style.display = 'none';
    }
    
    // Show the update profile button
    const updateProfileBtn = document.getElementById('update-profile-btn');
    if (updateProfileBtn) {
        updateProfileBtn.style.display = 'block';
        updateProfileBtn.style.animation = 'fadeInUp 0.8s ease-out';
    }
    
    // Mark as interacted
    window.breedUserHasInteracted = true;
    window.breedAccuracyChoice = 'yes';
    window.checkedBreeds = [];
}

function handleBreedNo() {
    // Hide the breed grid
    const breedGrid = document.getElementById('breed-predictions-card');
    if (breedGrid) {
        breedGrid.style.display = 'none';
    }
    
    // Hide the question section
    const questionSection = document.getElementById('breed-question-section');
    if (questionSection) {
        questionSection.style.display = 'none';
    }
    
    // Show the "No" response
    const noResponse = document.getElementById('breed-no-response');
    if (noResponse) {
        noResponse.style.display = 'block';
        noResponse.style.animation = 'fadeInUp 0.8s ease-out';
    }
    
    // Mark as interacted
    window.breedUserHasInteracted = true;
    window.breedAccuracyChoice = 'no';
}

function handleAccuracyChoice(choice) {
    // Store the choice for the next slide
    window.breedAccuracyChoice = choice;
    
    // Navigate to the next slide (breed feedback slide)
    setTimeout(() => {
        showSlide(currentSlide + 1);
    }, 500);
}

function flipBreedCard() {
    const flipCard = document.getElementById('breed-flip-card');
    if (flipCard) {
        if (!isCardFlipped) {
            flipCard.style.transform = 'rotateY(180deg)';
            isCardFlipped = true;
            
            // Add flip feedback
            flipCard.style.boxShadow = '0 10px 30px rgba(255, 255, 255, 0.3)';
    } else {
            flipCard.style.transform = 'rotateY(0deg)';
            isCardFlipped = false;
            
            // Remove flip feedback
            flipCard.style.boxShadow = 'none';
        }
    }
}

function submitPetProfile() {
    const profileLink = document.getElementById('pet-profile-link').value;
    if (profileLink.trim()) {
        // Add gamification feedback
        const submitBtn = document.querySelector('.breed-profile-submit-btn');
        submitBtn.textContent = 'Submitted! 🎉';
        submitBtn.style.background = 'linear-gradient(135deg, #4CAF50, #45a049)';
        submitBtn.style.transform = 'scale(1.05)';
        
        setTimeout(() => {
            alert('Thank you for submitting your pet profile! We\'ll use this to improve our predictions.');
        }, 500);
    } else {
        alert('Please enter a valid pet profile link.');
    }
}

function showIKnewIt() {
    // Create and show a popup message
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #4CAF50, #45a049);
        color: white;
        padding: 20px 30px;
        border-radius: 15px;
        font-size: 18px;
        font-weight: bold;
        z-index: 10000;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        animation: popupFadeIn 0.5s ease-out;
    `;
    popup.textContent = 'I knew it! 🎉';
    
    // Add animation CSS
    const style = document.createElement('style');
    style.textContent = `
        @keyframes popupFadeIn {
            from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            to { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }
    `;
    document.head.appendChild(style);
    
    document.body.appendChild(popup);
    
    // Remove popup after 2 seconds
    setTimeout(() => {
        popup.style.animation = 'popupFadeOut 0.5s ease-in';
        popup.style.cssText += `
            @keyframes popupFadeOut {
                from { opacity: 1; transform: translate(-50%, -50%) scale(1); }
                to { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            }
        `;
        setTimeout(() => {
            document.body.removeChild(popup);
        }, 500);
    }, 2000);
}

function handleBreedCheckboxChange(event) {
    // Prevent the flashcard from showing when checkbox is clicked
    event.stopPropagation();
    event.preventDefault();
    
    // Track checked breeds
    if (!window.checkedBreeds) {
        window.checkedBreeds = [];
    }
    
    const breedName = event.target.closest('.breed-card').getAttribute('data-breed');
    
    if (event.target.checked) {
        if (!window.checkedBreeds.includes(breedName)) {
            window.checkedBreeds.push(breedName);
        }
    } else {
        window.checkedBreeds = window.checkedBreeds.filter(breed => breed !== breedName);
    }
    
    console.log('Breed checkbox changed:', event.target.checked, 'Checked breeds:', window.checkedBreeds);
}

function handleBreedCardClick(event) {
    // Only show flashcard if the click wasn't on a checkbox or its label
    if (!event.target.closest('.breed-card-checkbox')) {
        const breedName = event.currentTarget.getAttribute('data-breed');
        const petName = event.currentTarget.getAttribute('data-pet');
        const confidence = event.currentTarget.getAttribute('data-confidence');
        const explanation = event.currentTarget.getAttribute('data-explanation');
        showBreedFlashcard(breedName, petName, confidence, explanation);
    }
}

function showBreedQuestionSection() {
    // Only show the question section if it hasn't been shown yet
    if (!window.breedQuestionShown) {
        const questionSection = document.querySelector('.breed-question-section');
        if (questionSection) {
            questionSection.style.display = 'block';
            questionSection.style.animation = 'fadeInUp 0.8s ease-out';
            window.breedQuestionShown = true;
            console.log('🎯 Breed question section shown after user interaction');
        }
    }
}

function resetBreedPredictionState() {
    // Reset breed prediction interactive elements when navigating to the slide
    console.log('🔄 Resetting breed prediction state...');
    
    // Check if user has already interacted with the breed prediction
    if (window.breedUserHasInteracted) {
        // Show updated state with visual feedback
        showBreedPredictionUpdatedState();
        } else {
        // Show question section for first-time visit
        const questionSection = document.querySelector('.breed-question-section');
        const noResponseSection = document.querySelector('.breed-no-response');
        const updateProfileSection = document.querySelector('.update-profile-section');
        
        if (questionSection) {
            questionSection.style.display = 'block';
            questionSection.style.animation = 'fadeInUp 0.8s ease-out';
        }
        if (noResponseSection) noResponseSection.style.display = 'none';
        if (updateProfileSection) updateProfileSection.style.display = 'none';
        
        // Reset state flags
        window.breedQuestionShown = true; // Mark as shown since it's visible
        window.breedAccuracyChoice = null;
        
        console.log('🔄 Breed prediction state reset - question section shown');
    }

function showBreedPredictionUpdatedState() {
    console.log('🎯 Showing breed prediction updated state...');
    
    // Hide interactive elements
    const questionSection = document.querySelector('.breed-question-section');
    const noResponseSection = document.querySelector('.breed-no-response');
    const updateProfileSection = document.querySelector('.update-profile-section');
    
    if (questionSection) questionSection.style.display = 'none';
    if (noResponseSection) noResponseSection.style.display = 'none';
    if (updateProfileSection) updateProfileSection.style.display = 'none';
    
    // Update breed cards with visual states and remove checkboxes
    const breedCards = document.querySelectorAll('.breed-card');
    breedCards.forEach(card => {
        const checkboxContainer = card.querySelector('.breed-card-checkbox');
        const breedNameElement = card.querySelector('.breed-card-name');
        const breedPercentageElement = card.querySelector('.breed-card-percentage');
        
        // Remove checkbox container entirely
        if (checkboxContainer) {
            checkboxContainer.style.display = 'none';
        }
        
        // Get all checkboxes to determine checked state
        const allCheckboxes = document.querySelectorAll('.breed-checkbox');
        const checkedBreeds = [];
        
        allCheckboxes.forEach(checkbox => {
            if (checkbox.checked) {
                const breedCard = checkbox.closest('.breed-card');
                const breedName = breedCard.getAttribute('data-breed');
                checkedBreeds.push(breedName);
            }
        });
        
        const breedName = card.getAttribute('data-breed');
        const isChecked = checkedBreeds.includes(breedName);
        
        // Apply visual states
        if (isChecked) {
            // ✅ Green for checked breeds
            card.style.background = 'linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1))';
            card.style.border = '2px solid #4CAF50';
            card.style.boxShadow = '0 4px 15px rgba(76, 175, 80, 0.3)';
            
            // Green text
            if (breedNameElement) breedNameElement.style.color = '#4CAF50';
            if (breedPercentageElement) breedPercentageElement.style.color = '#4CAF50';
            
            // Add checkmark
            if (!card.querySelector('.breed-checkmark')) {
                const checkmark = document.createElement('div');
                checkmark.className = 'breed-checkmark';
                checkmark.innerHTML = '✅';
                checkmark.style.cssText = `
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    font-size: 16px;
                    color: #4CAF50;
                `;
                card.appendChild(checkmark);
            }
        } else {
            // ❌ Red for unchecked breeds
            card.style.background = 'linear-gradient(135deg, rgba(244, 67, 54, 0.2), rgba(244, 67, 54, 0.1))';
            card.style.border = '2px solid #F44336';
            card.style.boxShadow = '0 4px 15px rgba(244, 67, 54, 0.3)';
            
            // Red text
            if (breedNameElement) breedNameElement.style.color = '#F44336';
            if (breedPercentageElement) breedPercentageElement.style.color = '#F44336';
            
            // Add X mark
            if (!card.querySelector('.breed-xmark')) {
                const xmark = document.createElement('div');
                xmark.className = 'breed-xmark';
                xmark.innerHTML = '❌';
                xmark.style.cssText = `
                    position: absolute;
                    top: 10px;
                    right: 10px;
                    font-size: 16px;
                    color: #F44336;
                `;
                card.appendChild(xmark);
            }
        }
    });
    
    // Show "Already updated" message
    showAlreadyUpdatedMessage();
    
    console.log('🎯 Breed prediction updated state applied - checkboxes removed');
}

function showAlreadyUpdatedMessage() {
    // Remove existing message if any
    const existingMessage = document.querySelector('.already-updated-message');
    if (existingMessage) {
        existingMessage.remove();
    }
    
    // Create and add the message
    const message = document.createElement('div');
    message.className = 'already-updated-message';
    message.innerHTML = '<span style="color: white; font-size: 18px; text-align: center; display: block; margin-top: 30px; font-weight: 500;">✅ Already updated</span>';
    message.style.cssText = `
        text-align: center;
        margin-top: 30px;
        animation: fadeInUp 0.8s ease-out;
        padding: 15px;
        background: linear-gradient(135deg, rgba(76, 175, 80, 0.1), rgba(76, 175, 80, 0.05));
        border-radius: 10px;
        border: 1px solid rgba(76, 175, 80, 0.3);
    `;
    
    // Add to breed container
    const breedContainer = document.querySelector('.breed-container');
    if (breedContainer) {
        breedContainer.appendChild(message);
    }
}
}

function updatePetProfile() {
    // Get the pet name from the page
    const petHighlight = document.querySelector('.breed-highlight-text strong');
    let petName = 'your pet';
    if (petHighlight) {
        petName = petHighlight.textContent.trim();
    }
    
    // Create a personalized popup message
    const popup = document.createElement('div');
    popup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #4CAF50, #45a049);
        color: white;
        padding: 20px 30px;
        border-radius: 15px;
        font-size: 18px;
        font-weight: bold;
        z-index: 10000;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        animation: popupFadeIn 0.5s ease-out;
        text-align: center;
    `;
    popup.innerHTML = `<div>${petName}'s pet profile is updated! 🎉</div>`;
    
    document.body.appendChild(popup);
    
    // Remove the popup after 3 seconds
    setTimeout(() => {
        popup.style.animation = 'popupFadeOut 0.5s ease-out';
        setTimeout(() => {
            if (popup.parentNode) {
                popup.parentNode.removeChild(popup);
            }
        }, 500);
    }, 3000);
    
    // Hide the update profile button
    const updateProfileBtn = document.getElementById('update-profile-btn');
    if (updateProfileBtn) {
        updateProfileBtn.style.display = 'none';
    }
    
    // Mark as interacted
    window.breedUserHasInteracted = true;
}

function completePetProfile() {
    // Open Chewy profile page in new tab
    window.open('https://www.chewy.com/account/profile', '_blank');
}

function initializeBreedPredictionSlide() {
    // Initialize breed prediction slide with question visible
    console.log('🎯 Initializing breed prediction slide...');
    
    // Show question section initially
    const questionSection = document.querySelector('.breed-question-section');
    if (questionSection) {
        questionSection.style.display = 'block';
        questionSection.style.animation = 'fadeInUp 0.8s ease-out';
    }
    
    // Hide other interactive elements initially
    const noResponseSection = document.querySelector('.breed-no-response');
    const updateProfileSection = document.querySelector('.update-profile-section');
    
    if (noResponseSection) noResponseSection.style.display = 'none';
    if (updateProfileSection) updateProfileSection.style.display = 'none';
    
    console.log('🎯 Breed prediction question section shown initially');
}

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    // Page is ready
});

function showBreedFlashcardFromData(element) {
    const breedName = element.getAttribute('data-breed');
    const petName = element.getAttribute('data-pet');
    const confidence = element.getAttribute('data-confidence');
    const explanation = element.getAttribute('data-explanation');
    showBreedFlashcard(breedName, petName, confidence, explanation);
}

function showBreedFlashcard(breedName, petName, confidence, explanation) {
    console.log(`🐕 Showing flashcard for ${breedName} (${petName}) - ${confidence}%`);
    
    // Update flashcard content
    document.getElementById('flashcard-breed-name').textContent = breedName.replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
    
    // Use the explanation if provided, otherwise fall back to breed description
    let description;
    if (explanation && explanation !== 'No explanation available') {
        description = `
            <p style="background: rgba(44, 95, 139, 0.08); padding: 15px; border-radius: 10px; margin-top: 10px; line-height: 1.6; color: #4A5F6B; border: 1px solid rgba(44, 95, 139, 0.1);">
                ${explanation}
            </p>
        `;
    } else {
    // Get breed description from our database
        description = getBreedDescription(breedName);
    }
    
    document.getElementById('flashcard-description').innerHTML = description;
    
    // Show the modal
    document.getElementById('breed-flashcard-modal').style.display = 'block';
}

function closeBreedFlashcard() {
    document.getElementById('breed-flashcard-modal').style.display = 'none';
}

function getBreedDescription(breedName) {
    // Breed descriptions database
    const breedDescriptions = {
        'Shih Tzu': `
            <h4>Shih Tzu</h4>
            <p><strong>Size:</strong> Small (9-16 lbs)</p>
            <p><strong>Temperament:</strong> Affectionate, friendly, and outgoing. Known for their sweet, gentle nature and love of companionship.</p>
            <p><strong>Characteristics:</strong> Long, flowing coat, distinctive pushed-in face, and a proud carriage. Excellent companion dogs that adapt well to apartment living.</p>
            <p><strong>Care:</strong> Requires regular grooming due to their long coat. Moderate exercise needs and thrives on human interaction.</p>
        `,
        'Golden Retriever': `
            <h4>Golden Retriever</h4>
            <p><strong>Size:</strong> Large (55-75 lbs)</p>
            <p><strong>Temperament:</strong> Intelligent, friendly, and devoted. Known for their gentle temperament and patience with children.</p>
            <p><strong>Characteristics:</strong> Beautiful golden coat, muscular build, and kind expression. Excellent family dogs and working dogs.</p>
            <p><strong>Care:</strong> Regular exercise and grooming needed. Highly trainable and eager to please.</p>
        `,
        'Labrador Retriever': `
            <h4>Labrador Retriever</h4>
            <p><strong>Size:</strong> Large (55-80 lbs)</p>
            <p><strong>Temperament:</strong> Friendly, outgoing, and high-spirited. Known for their intelligence and versatility.</p>
            <p><strong>Characteristics:</strong> Short, dense coat, otter-like tail, and kind expression. Excellent working dogs and family companions.</p>
            <p><strong>Care:</strong> High energy levels require regular exercise. Easy to groom and highly trainable.</p>
        `,
        'German Shepherd': `
            <h4>German Shepherd</h4>
            <p><strong>Size:</strong> Large (50-90 lbs)</p>
            <p><strong>Temperament:</strong> Intelligent, loyal, and courageous. Known for their protective nature and working ability.</p>
            <p><strong>Characteristics:</strong> Strong, muscular build, erect ears, and confident stance. Excellent working dogs and family protectors.</p>
            <p><strong>Care:</strong> Requires mental and physical stimulation. Regular grooming and training essential.</p>
        `,
        'Mixed / Unknown': `
            <h4>Mixed Breed</h4>
            <p><strong>Size:</strong> Variable</p>
            <p><strong>Temperament:</strong> Unique combination of traits from different breeds. Often healthy and adaptable.</p>
            <p><strong>Characteristics:</strong> One-of-a-kind appearance and personality. Each mixed breed is truly unique!</p>
            <p><strong>Care:</strong> Care needs depend on the mix of breeds. Generally adaptable and loving companions.</p>
        `,
        'Other': `
            <h4>Special Breed</h4>
            <p><strong>Size:</strong> Variable</p>
            <p><strong>Temperament:</strong> Unique and special! Every breed has its own wonderful characteristics.</p>
            <p><strong>Characteristics:</strong> Your pet is one-of-a-kind with their own special traits and personality.</p>
            <p><strong>Care:</strong> Each breed has specific care requirements that make them special.</p>
        `
    };
    
    // Return description or default
    return breedDescriptions[breedName] || `
        <h4>${breedName}</h4>
        <p>This is a wonderful breed with unique characteristics and personality traits!</p>
        <p>Every breed has its own special qualities that make them perfect companions.</p>
        <p>Your pet's individual personality makes them truly special regardless of breed.</p>
    `;
}

// Close flashcard when clicking outside
document.addEventListener('click', function(e) {
    const modal = document.getElementById('breed-flashcard-modal');
    const content = document.querySelector('.breed-flashcard-content');
    
    if (e.target === modal) {
        closeBreedFlashcard();
    }
});

// Feature Selection Functions
let selectedFeatures = new Set();

function toggleFeature(feature) {
    const card = document.querySelector(`[data-feature="${feature}"]`);
    
    if (selectedFeatures.has(feature)) {
        selectedFeatures.delete(feature);
        card.classList.remove('selected');
    } else {
        selectedFeatures.add(feature);
        card.classList.add('selected');
    }
    
    // Update share button state
    updateShareButton();
}

function updateShareButton() {
    const shareBtn = document.querySelector('.enhanced-share-btn');
    if (selectedFeatures.size > 0) {
        shareBtn.style.opacity = '1';
        shareBtn.style.cursor = 'pointer';
    } else {
        shareBtn.style.opacity = '0.6';
        shareBtn.style.cursor = 'not-allowed';
    }
}

function showIOSShareSheet() {
    if (selectedFeatures.size === 0) {
        alert('Please select at least one feature to share!');
        return;
    }
    
    const overlay = document.getElementById('ios-share-overlay');
    overlay.classList.add('show');
}

function hideIOSShareSheet() {
    const overlay = document.getElementById('ios-share-overlay');
    overlay.classList.remove('show');
}

// Close share sheet when clicking outside
document.getElementById('ios-share-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
        hideIOSShareSheet();
    }
});

function shareToApp(app) {
    const customerId = '{{ customer_id }}';
    const shareUrl = `${window.location.origin}/experience/${customerId}`;
    const shareText = "Check out my personalized Chewy pet experience!";
    
    // Create share text based on selected features
    let featureText = "Features: ";
    selectedFeatures.forEach(feature => {
        switch(feature) {
            case 'food':
                featureText += "🍽️ Food Stats, ";
                break;
            case 'portrait':
                featureText += "🎨 AI Portrait, ";
                break;
            case 'letter':
                featureText += "💌 Pet Letter, ";
                break;
            case 'breed':
                featureText += "🐕 Breed Prediction, ";
                break;
        }
    });
    
    const fullShareText = `${shareText} ${featureText.slice(0, -2)} ${shareUrl}`;
    
    let shareLink = '';
    
    switch(app) {
        case 'instagram':
            // Instagram doesn't support direct sharing via URL, so we'll copy to clipboard
            copyToClipboard(`${fullShareText}`);
            alert('Link copied to clipboard! You can now paste it in Instagram.');
            hideIOSShareSheet();
            return;
        case 'messages':
            shareLink = `sms:?body=${encodeURIComponent(fullShareText)}`;
            break;
        case 'whatsapp':
            shareLink = `https://wa.me/?text=${encodeURIComponent(fullShareText)}`;
            break;
        case 'facebook':
            shareLink = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(shareText)}`;
            break;
    }
    
    if (shareLink) {
        window.open(shareLink, '_blank', 'width=600,height=400');
        hideIOSShareSheet();
    }
}

function copyShareLink() {
    const customerId = '{{ customer_id }}';
    const shareUrl = `${window.location.origin}/experience/${customerId}`;
    copyToClipboard(shareUrl);
    alert('Link copied to clipboard!');
    hideIOSShareSheet();
}

function saveToPhotos() {
    // This would typically involve taking a screenshot or generating an image
    // For now, we'll just show a message
    alert('Save to Photos feature would capture your experience as an image!');
    hideIOSShareSheet();
}

// Social Media Sharing Functions
function shareToSocial(platform) {
    const customerId = '{{ customer_id }}';
    const shareUrl = `${window.location.origin}/experience/${customerId}`;
    const shareText = "Check out my personalized Chewy pet experience!";
    
    let shareLink = '';
    
    switch(platform) {
        case 'facebook':
            shareLink = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(shareText)}`;
            break;
        case 'instagram':
            // Instagram doesn't support direct sharing via URL, so we'll copy to clipboard
            copyToClipboard(`${shareText} ${shareUrl}`);
            alert('Link copied to clipboard! You can now paste it in Instagram.');
            return;
        case 'snapchat':
            // Snapchat doesn't support direct sharing via URL, so we'll copy to clipboard
            copyToClipboard(`${shareText} ${shareUrl}`);
            alert('Link copied to clipboard! You can now paste it in Snapchat.');
            return;
        case 'whatsapp':
            shareLink = `https://wa.me/?text=${encodeURIComponent(shareText + ' ' + shareUrl)}`;
            break;
        case 'message':
            // For SMS sharing
            if (navigator.share) {
                navigator.share({
                    title: 'My Chewy Experience',
                    text: shareText,
                    url: shareUrl
                });
            } else {
                shareLink = `sms:?body=${encodeURIComponent(shareText + ' ' + shareUrl)}`;
            }
            break;
    }
    
    if (shareLink) {
        window.open(shareLink, '_blank', 'width=600,height=400');
    }
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text);
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
    }
}

// Highlight number + item patterns in fun facts
function highlightFunFactNumbers() {
    const funFactMessages = document.querySelectorAll('.funfact-message');
    
    funFactMessages.forEach(message => {
        const text = message.innerHTML;
        // Regex to match patterns like "2 black bears", "5 tennis balls", etc.
        const highlightedText = text.replace(/(\d+(?:\.\d+)?)\s+([a-zA-Z\s]+)/g, 
            '<span class="highlight-number">$1 $2</span>');
        message.innerHTML = highlightedText;
    });
}

// Run highlighting when page loads
document.addEventListener('DOMContentLoaded', function() {
    highlightFunFactNumbers();
});
</script>
{% endblock %} 