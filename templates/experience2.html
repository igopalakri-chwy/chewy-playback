{% extends "base.html" %}

{% block title %}Pet Experience - Customer {{ customer_id }} - Chewy Playback{% endblock %}

{% block content %}
<script>
// Dynamic styling based on data content
function getDynamicStyles(data) {
    const styles = {};
    
    // Food consumption styling
    const foodLbs = parseFloat(data.food_consumption.total_lbs) || 0;
    if (foodLbs > 100) {
        styles.foodIcon = 'color: #4a90e2; font-size: 70px;';
        styles.foodTitle = 'color: #4a90e2; font-size: 28px;';
    } else if (foodLbs > 50) {
        styles.foodIcon = 'color: #4a90e2; font-size: 60px;';
        styles.foodTitle = 'color: #4a90e2; font-size: 24px;';
    } else {
        styles.foodIcon = 'color: #4a90e2; font-size: 50px;';
        styles.foodTitle = 'color: #4a90e2; font-size: 20px;';
    }
    
    // Donations styling
    const donationAmount = parseFloat(data.donations.total_donations.replace('$', '')) || 0;
    if (donationAmount > 50) {
        styles.donationGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.donationIcon = 'color: #4a90e2; font-size: 70px;';
    } else if (donationAmount > 20) {
        styles.donationGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.donationIcon = 'color: #4a90e2; font-size: 60px;';
    } else {
        styles.donationGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.donationIcon = 'color: #4a90e2; font-size: 50px;';
    }
    
    // Milestone styling
    const months = parseInt(data.milestone.months) || 0;
    if (months > 60) {
        styles.milestoneGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.milestoneShadow = '0 15px 35px rgba(74,144,226,0.4)';
    } else if (months > 24) {
        styles.milestoneGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.milestoneShadow = '0 10px 25px rgba(74,144,226,0.3)';
    } else {
        styles.milestoneGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.milestoneShadow = '0 8px 20px rgba(74,144,226,0.2)';
    }
    
    // Most reordered styling
    const timesOrdered = parseInt(data.most_reordered.times_ordered) || 0;
    if (timesOrdered > 100) {
        styles.reorderIcon = 'color: #4a90e2; font-size: 70px;';
        styles.reorderTitle = 'color: #4a90e2; font-size: 28px;';
    } else if (timesOrdered > 50) {
        styles.reorderIcon = 'color: #4a90e2; font-size: 60px;';
        styles.reorderTitle = 'color: #4a90e2; font-size: 24px;';
    } else {
        styles.reorderIcon = 'color: #4a90e2; font-size: 50px;';
        styles.reorderTitle = 'color: #4a90e2; font-size: 20px;';
    }
    
    // Busiest month styling
    const monthOrders = parseInt(data.cuddliest_month.orders) || 0;
    if (monthOrders > 10) {
        styles.monthGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.monthShadow = '0 15px 35px rgba(74,144,226,0.4)';
    } else if (monthOrders > 5) {
        styles.monthGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.monthShadow = '0 10px 25px rgba(74,144,226,0.3)';
    } else {
        styles.monthGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.monthShadow = '0 8px 20px rgba(74,144,226,0.2)';
    }
    
    // Autoship savings styling
    const savings = parseFloat(data.autoship_savings.amount_saved) || 0;
    if (savings > 50) {
        styles.savingsGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.savingsIcon = 'color: #4a90e2; font-size: 70px;';
    } else if (savings > 20) {
        styles.savingsGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.savingsIcon = 'color: #4a90e2; font-size: 60px;';
    } else {
        styles.savingsGradient = 'linear-gradient(135deg, #4a90e2, #2a5298)';
        styles.savingsIcon = 'color: #4a90e2; font-size: 50px;';
    }
    
    return styles;
}

// Apply dynamic styles when page loads
document.addEventListener('DOMContentLoaded', function() {
    const customerData = JSON.parse('{{ customer_data | tojson | safe }}');
    const styles = getDynamicStyles(customerData);
    
    // Apply styles to elements
    const foodIcon = document.querySelector('.funfact-icon i');
    if (foodIcon) foodIcon.style.cssText = styles.foodIcon;
    
    const donationIcon = document.querySelector('.breed-icon i');
    if (donationIcon) donationIcon.style.cssText = styles.donationIcon;
    
    const donationContainer = document.querySelector('.breed-content > div');
    if (donationContainer) donationContainer.style.background = styles.donationGradient;
    
    const milestoneContainer = document.querySelector('.letter-text > div');
    if (milestoneContainer) {
        milestoneContainer.style.background = styles.milestoneGradient;
        milestoneContainer.style.boxShadow = styles.milestoneShadow;
    }
    
    const reorderIcon = document.querySelector('.badge-image-container i');
    if (reorderIcon) reorderIcon.style.cssText = styles.reorderIcon;
    
    const monthContainer = document.querySelector('.portrait-display > div > div:nth-child(2)');
    if (monthContainer) {
        monthContainer.style.background = styles.monthGradient;
        monthContainer.style.boxShadow = styles.monthShadow;
    }
    
    const savingsIcon = document.querySelector('.share-content i');
    if (savingsIcon) savingsIcon.style.cssText = styles.savingsIcon;
    
    const savingsContainer = document.querySelector('.share-message > div > div:nth-child(3)');
    if (savingsContainer) savingsContainer.style.background = styles.savingsGradient;
});
</script>

<div class="experience-container">

    
    <!-- Navigation -->
    <div class="slide-nav">
        <div class="nav-dots">
            <div class="nav-dot active" data-slide="0"></div>
            <div class="nav-dot" data-slide="1"></div>
            <div class="nav-dot" data-slide="2"></div>
            <div class="nav-dot" data-slide="3"></div>
            <div class="nav-dot" data-slide="4"></div>
            <div class="nav-dot" data-slide="5"></div>
            <div class="nav-dot" data-slide="6"></div>
            <div class="nav-dot" data-slide="7"></div>
        </div>
    </div>
    
    <!-- Slides Container -->
    <div class="slides-container">
        <!-- Slide 0: Loading -->
        <div class="slide active" id="slide-0">
            <div class="slide-content loading-slide">
                <div class="loading-container">
                    <div class="loading-header">
                        <div class="loading-icon">
                            <i class="fas fa-paw"></i>
                        </div>
                        <h2 class="loading-title">Preparing Your Playback</h2>
                        <p class="loading-subtitle">Gathering your pet's story...</p>
                    </div>
                    
                    <div class="loading-progress">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <div class="loading-messages">
                            <span class="loading-message" id="loadingMessage">Fetching pet memories...</span>
                        </div>
                    </div>
                    
                    <div class="loading-animation">
                        <div class="floating-paws">
                            <div class="floating-paw fp-1"><i class="fas fa-paw"></i></div>
                            <div class="floating-paw fp-2"><i class="fas fa-heart"></i></div>
                            <div class="floating-paw fp-3"><i class="fas fa-star"></i></div>
                            <div class="floating-paw fp-4"><i class="fas fa-paw"></i></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Slide 1: Total lbs Food Consumed -->
        <div class="slide" id="slide-1">
            <div class="slide-content funfact-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">üçΩÔ∏è</span> Total lbs Food Consumed <span class="emoji celebration">üçΩÔ∏è</span>
                    </h2>
                </div>
                
                <div class="funfact-container">
                    <div class="funfact-icon">
                        <i class="fas fa-weight" style="font-size: 60px; color: #4a90e2;"></i>
                    </div>
                    <div class="funfact-content">
                        <h3 class="funfact-title" style="color: white; font-size: 24px; margin-bottom: 20px;">Your Pet's Food Journey</h3>
                        <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                            <h4 style="color: #4a90e2; font-size: 32px; margin-bottom: 10px; text-align: center;">
                                {{ customer_data.food_consumption.total_lbs }} lbs
                            </h4>
                            <p style="color: white; font-size: 18px; text-align: center; margin-bottom: 15px;">
                                of delicious food consumed this year!
                            </p>
                        </div>
                        <div class="funfact-highlight" style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 20px; border-radius: 10px;">
                            <h5 style="color: white; margin-bottom: 10px;">üèÜ Top Product:</h5>
                            <p class="funfact-text" style="color: white; font-size: 16px; font-weight: bold;">
                                {{ customer_data.food_consumption.top_product }}
                            </p>
                            <a href="https://www.chewy.com/search?query={{ customer_data.food_consumption.top_product | urlencode }}" target="_blank" style="color: #4a90e2; text-decoration: none; font-weight: bold; display: inline-block; margin-top: 10px;">
                                üîó View Product ‚Üí
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Slide 2: Donations -->
        {% if customer_data.donations.total_donations != '$0' and customer_data.donations.total_donations != '0' %}
        <div class="slide" id="slide-2">
            <div class="slide-content breed-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">‚ù§Ô∏è</span> Donations <span class="emoji celebration">‚ù§Ô∏è</span>
                    </h2>
                </div>
                
                <div class="breed-container">
                    <div class="breed-icon">
                        <i class="fas fa-heart" style="font-size: 60px; color: #4a90e2; animation: pulse 2s infinite;"></i>
                    </div>
                    <div class="breed-content">
                        <h3 class="breed-title" style="color: white; font-size: 24px; margin-bottom: 20px; text-align: center;">Your Generosity Makes a Difference</h3>
                        <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 30px; border-radius: 20px; margin-bottom: 20px; text-align: center;">
                            <h4 style="color: white; font-size: 36px; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                                {{ customer_data.donations.total_donations }}
                            </h4>
                            <p style="color: white; font-size: 18px; margin-bottom: 0;">
                                Total Donations This Year
                            </p>
                        </div>
                        <div class="breed-disclaimer" style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; text-align: center;">
                            <p class="disclaimer-text"  style="color: #2d4782; font-size: 16px; line-height: 1.6;">
                                {{ customer_data.donations.summary }}
                            </p>
                            <div style="margin-top: 15px;">
                                <span style="color: #4a90e2; font-size: 24px;">üêæ</span>
                                <span style="color: #4a90e2; font-size: 24px;">üêæ</span>
                                <span style="color: #4a90e2; font-size: 24px;">üêæ</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        {% endif %}
        
        <!-- Slide 3: Milestone -->
        <div class="slide" id="slide-3">
            <div class="slide-content letter-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">üéä</span> Milestone: Years with Chewy <span class="emoji celebration">üéä</span>
                    </h2>
                </div>
                
                <div class="letter-container">
                    <div class="letter-content">
                        <div class="letter-text" style="text-align: center;">
                            <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 40px; border-radius: 25px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(74,144,226,0.3);">
                                <i class="fas fa-trophy" style="font-size: 60px; color: white; margin-bottom: 20px; display: block;"></i>
                                <!-- <h3 style="color: white; font-size: 28px; margin-bottom: 15px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                                    üéâ Congratulations! üéâ
                                </h3> -->
                                <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin: 20px 0;">
                                    <h4 style="color: white; font-size: 48px; margin-bottom: 10px; font-weight: bold;">
                                        {{ customer_data.milestone.months }}
                                    </h4>
                                    <p style="color: white; font-size: 20px; margin-bottom: 0;">
                                        Amazing Months with Chewy!
                                    </p>
                                </div>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px;">
                                <p style="color: white; font-size: 18px; line-height: 1.6; margin-bottom: 0;">
                                    {{ customer_data.milestone.message }}
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Slide 4: Most Reordered -->
        <div class="slide" id="slide-4">
            <div class="slide-content badge-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">üîÑ</span> Most Reordered <span class="emoji celebration">üîÑ</span>
                    </h2>
                </div>
                
                <div class="badge-container">
                    <div class="badge-display">
                        <div class="badge-image-container" style="text-align: center; margin-bottom: 30px;">
                            <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto; box-shadow: 0 10px 30px rgba(74,144,226,0.4);">
                                <i class="fas fa-shopping-cart" style="font-size: 60px; color: white;"></i>
                            </div>
                        </div>
                        <div class="badge-info">
                            <h3 class="badge-title" style="color: white; font-size: 24px; margin-bottom: 20px; text-align: center;">Your Favorite Product</h3>
                            <div style="background: rgba(255,255,255,0.1); padding: 25px; border-radius: 15px; margin-bottom: 20px; text-align: center;">
                                <h4 style="color: #4a90e2; font-size: 20px; margin-bottom: 15px;">üèÜ Most Reordered:</h4>
                                <p class="badge-description" style="color: #2d4782; font-size: 18px; font-weight: bold; margin-bottom: 0;">
                                    {{ customer_data.most_reordered.product_name }}
                                </p>
                            </div>
                            
                            <div class="compatible-section">
                                <h4 class="compatible-title"  style="color: #2d4782; text-align: center; margin-bottom: 15px;">üìä Order Statistics</h4>
                                <div class="compatible-badges" style="display: flex; justify-content: center;">
                                    <div class="compatible-badge" style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 20px; border-radius: 10px; text-align: center;">
                                        <div  style="color: #2d4782; font-size: 24px; font-weight: bold; margin-bottom: 5px;">
                                            {{ customer_data.most_reordered.times_ordered }}
                                        </div>
                                        <span class="compatible-name"  style="color: #2d4782; font-size: 14px;">Times Ordered</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Slide 5: Cuddliest Month -->
        <div class="slide" id="slide-5">
            <div class="slide-content portrait-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">üìÖ</span> Busiest Month <span class="emoji celebration">üìÖ</span>
                    </h2>
                </div>
                
                <div class="portrait-container">
                    <div class="portrait-display">
                        <div style="text-align: center; padding: 40px;">
                            <!-- <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); width: 140px; height: 140px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px; box-shadow: 0 15px 35px rgba(74,144,226,0.4);">
                                <i class="fas fa-calendar-heart" style="font-size: 70px; color: white;"></i>
                            </div> -->
                            
                            <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 30px; border-radius: 20px; margin-bottom: 25px; box-shadow: 0 10px 25px rgba(74,144,226,0.3);">
                                <h3 style="color: white; font-size: 32px; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                                    {{ customer_data.cuddliest_month.month }}
                                </h3>
                                <p style="color: white; font-size: 18px; margin-bottom: 0; opacity: 0.9;">
                                    Your Busiest Month with Chewy! üíï
                                </p>
                            </div>
                            
                            <div style="display: flex; justify-content: center; margin-top: 25px;">
                                <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 15px; text-align: center;">
                                    <div style="color: #4a90e2; font-size: 28px; font-weight: bold; margin-bottom: 8px;">
                                        {{ customer_data.cuddliest_month.orders }}
                                    </div>
                                    <div style="color: #2d4782; font-size: 14px;">Orders</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Slide 6: Savings from Autoship -->
        {% if customer_data.autoship_savings.amount_saved != '0' and customer_data.autoship_savings.amount_saved != '0.0' %}
        <div class="slide" id="slide-6">
            <div class="slide-content share-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        <span class="emoji celebration">üí∞</span> Savings from Autoship <span class="emoji celebration">üí∞</span>
                    </h2>
                </div>
                
                <div class="share-container">
                    <div class="share-content">
                        <div class="share-message">
                            <div style="text-align: center; padding: 20px;">
                                <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); width: 120px; height: 120px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 30px; box-shadow: 0 15px 35px rgba(74,144,226,0.4);">
                                    <i class="fas fa-piggy-bank" style="font-size: 60px; color: white;"></i>
                                </div>
                                
                                <h3 class="share-title" style="color: white; font-size: 28px; margin-bottom: 25px;">üí∞ You Saved Big with Autoship!</h3>
                                
                                <div style="background: linear-gradient(135deg, #4a90e2, #2a5298); padding: 40px; border-radius: 25px; margin-bottom: 30px; box-shadow: 0 15px 35px rgba(74,144,226,0.3);">
                                    <div style="background: rgba(255,255,255,0.2); padding: 30px; border-radius: 20px; margin-bottom: 20px;">
                                        <h4 style="color: white; font-size: 48px; margin-bottom: 10px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                                            ${{ customer_data.autoship_savings.amount_saved }}
                                        </h4>
                                        <p style="color: white; font-size: 20px; margin-bottom: 0; opacity: 0.9;">
                                            Total Savings This Year
                                        </p>
                                    </div>
                                    
                                    <div style="background: rgba(255,255,255,0.15); padding: 20px; border-radius: 15px;">
                                        <p style="color: white; font-size: 18px; line-height: 1.6; margin-bottom: 0;">
                                            {{ customer_data.autoship_savings.message }}
                                        </p>
                                    </div>
                                </div>
                                
                                <!-- <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px;">
                                    <p style="color: #4a90e2; font-size: 16px; margin-bottom: 0; font-weight: bold;">
                                        üéâ Keep using autoship to save even more! üéâ
                                    </p>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn next-btn" onclick="nextSlide()">
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        {% endif %}
        
        <!-- Slide 6: Social Media Sharing -->
        <div class="slide" id="slide-6">
            <div class="slide-content share-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0;">
                        Share Your Pet's Amazing Story
                    </h2>
                </div>
                
                <div class="share-container">
                    <div class="share-content">
                        <div class="share-message">
                            <h3 class="share-title"><span class="emoji paw">üêæ</span> Ready to Show Off Your Furry Friends? <span class="emoji paw">üêæ</span></h3>
                            <!-- <p class="share-description">
                                Your pets have an amazing story to tell! Share this special playback with your friends and family on social media.
                            </p> -->
                        </div>
                        
                        <div class="social-platforms">
                            <div class="platform-grid">
                                <button class="platform-btn whatsapp-btn" onclick="shareToWhatsApp()">
                                    <i class="fab fa-whatsapp"></i>
                                    <span>WhatsApp</span>
                                </button>
                                
                                <button class="platform-btn instagram-btn" onclick="shareToInstagram()">
                                    <i class="fab fa-instagram"></i>
                                    <span>Instagram</span>
                                </button>
                                
                                <button class="platform-btn facebook-btn" onclick="shareToFacebook()">
                                    <i class="fab fa-facebook-f"></i>
                                    <span>Facebook</span>
                                </button>
                                
                                <button class="platform-btn messages-btn" onclick="shareToMessages()">
                                    <i class="fas fa-comment"></i>
                                    <span>Messages</span>
                                </button>
                                
                                <button class="platform-btn linkedin-btn" onclick="shareToLinkedIn()">
                                    <i class="fab fa-linkedin-in"></i>
                                    <span>LinkedIn</span>
                                </button>
                                
                                <button class="platform-btn copy-btn" onclick="copyLink()">
                                    <i class="fas fa-link"></i>
                                    <span>Copy Link</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- <div class="share-footer">
                            <p class="share-note">üíù Spread the love and let everyone know how amazing your pets are!</p>
                        </div> -->
                    </div>
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn home-btn" onclick="goHome()">
                        <i class="fas fa-home"></i>
                    </button>
                </div>
            </div>
        </div>
        

        
        <!-- Slide 7: Unknowns -->
        <div class="slide" id="slide-7">
            <div class="slide-content unknowns-slide">
                <div class="slide-header" style="text-align: center; margin-bottom: 30px;">
                    <h2 class="slide-title" style="text-align: center; margin: 0; color: white;">
                        <span class="emoji search">üîç</span> Missing Information
                    </h2>
                </div>
                
                <div class="unknowns-container">
                    {% if customer_data.unknowns %}
                        <div class="unknowns-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <div class="unknowns-content">
                            <h3 class="unknowns-title">Help Us Know Your Pets Better</h3>
                            <p class="unknowns-description">
                                We found some missing information in your pet profiles. Adding these details will help us create even more personalized experiences!
                            </p>
                            
                            <div class="pets-unknowns">
                                {% for pet_name, pet_data in customer_data.unknowns.unknown_attributes.items() %}
                                <div class="pet-unknown">
                                    <div class="pet-name">
                                        <h4 class="pet-title">{{ pet_data.pet_name }}</h4>
                                    </div>
                                    <div class="unknown-fields">
                                        <p class="fields-label">Missing:</p>
                                        <div class="field-tags">
                                            {% for field in pet_data.unknown_fields %}
                                            <span class="field-tag">{{ field.replace('_', ' ').title() }}</span>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                            
                            <div class="unknowns-summary">
                                <p class="summary-text">
                                    Total missing fields: {{ customer_data.unknowns.total_unknowns }} across {{ customer_data.unknowns.pets_with_unknowns }} pets
                                </p>
                            </div>
                        </div>
                    {% else %}
                        <div class="unknowns-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="unknowns-content">
                            <h3 class="unknowns-title">Complete Profiles!</h3>
                            <p class="unknowns-description">
                                Great job! All your pet profiles are complete. We have all the information we need to create amazing experiences for your furry friends.
                            </p>
                        </div>
                    {% endif %}
                </div>
                
                <div class="slide-actions">
                    <button class="nav-btn prev-btn" onclick="prevSlide()">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="nav-btn home-btn" onclick="goHome()">
                        <i class="fas fa-home"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
let currentSlide = 0;
let totalSlides = 10;
let isTransitioning = false;

// Function to count visible slides and update navigation
function updateSlideCount() {
    const visibleSlides = document.querySelectorAll('.slide').length;
    totalSlides = visibleSlides;
    
    // Update navigation dots to match visible slides
    const navDots = document.querySelector('.nav-dots');
    if (navDots) {
        navDots.innerHTML = '';
        for (let i = 0; i < visibleSlides; i++) {
            const dot = document.createElement('div');
            dot.className = `nav-dot ${i === 0 ? 'active' : ''}`;
            dot.setAttribute('data-slide', i);
            dot.addEventListener('click', () => showSlide(i));
            navDots.appendChild(dot);
        }
    }
}

// Loading animation variables
let loadingProgress = 0;
let loadingInterval;
let messageIndex = 0;
const loadingMessages = [
    "Fetching pet memories...",
    "Almost ready..."
];

function showSlide(slideIndex) {
    if (isTransitioning || slideIndex === currentSlide) return;
    
    isTransitioning = true;
    
    // Get all visible slides
    const visibleSlides = Array.from(document.querySelectorAll('.slide'));
    
    // Hide all slides
    visibleSlides.forEach(slide => {
        slide.classList.remove('active');
    });
    
    // Show current slide
    if (visibleSlides[slideIndex]) {
        visibleSlides[slideIndex].classList.add('active');
    }
    
    // Update navigation dots
    document.querySelectorAll('.nav-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === slideIndex);
    });
    
    currentSlide = slideIndex;
    
    // Allow transitions after animation completes
    setTimeout(() => {
        isTransitioning = false;
    }, 500);
}

function nextSlide() {
    if (currentSlide < totalSlides - 1) {
        showSlide(currentSlide + 1);
    }
}

function prevSlide() {
    if (currentSlide > 0) {
        showSlide(currentSlide - 1);
    }
}

function goHome() {
    window.location.href = '/';
}

// Navigation dot clicks
document.querySelectorAll('.nav-dot').forEach((dot, index) => {
    dot.addEventListener('click', () => {
        showSlide(index);
    });
});

// Keyboard navigation
document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') {
        nextSlide();
    } else if (e.key === 'ArrowLeft') {
        prevSlide();
    }
});

// Touch/swipe support
let touchStartX = 0;
let touchEndX = 0;

document.addEventListener('touchstart', (e) => {
    touchStartX = e.changedTouches[0].screenX;
});

document.addEventListener('touchend', (e) => {
    touchEndX = e.changedTouches[0].screenX;
    handleSwipe();
});

function handleSwipe() {
    const swipeThreshold = 50;
    const diff = touchStartX - touchEndX;
    
    if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0) {
            // Swipe left - next slide
            nextSlide();
        } else {
            // Swipe right - previous slide
            prevSlide();
        }
    }
}

// Loading Animation Functions
function startLoadingAnimation() {
    const progressFill = document.getElementById('progressFill');
    const loadingMessage = document.getElementById('loadingMessage');
    
    if (!progressFill || !loadingMessage) return;
    
    loadingInterval = setInterval(() => {
        loadingProgress += 2;
        
        if (loadingProgress <= 100) {
            progressFill.style.width = loadingProgress + '%';
            
            // Update message every 20%
            if (loadingProgress % 20 === 0 && messageIndex < loadingMessages.length) {
                loadingMessage.textContent = loadingMessages[messageIndex];
                messageIndex++;
            }
        } else {
            clearInterval(loadingInterval);
            // Auto-advance to next slide after loading completes
            setTimeout(() => {
                nextSlide();
            }, 500);
        }
    }, 100);
}

// Start loading animation when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Update slide count based on visible slides
    updateSlideCount();
    
    if (currentSlide === 0) {
        startLoadingAnimation();
    }
});

// Social Media Sharing Functions
function shareToWhatsApp() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent("üêæ Check out my pet's amazing story! üêæ");
    window.open(`https://wa.me/?text=${text}%20${url}`, '_blank');
}

function shareToInstagram() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent("üêæ My pet's story is incredible! üêæ");
    // Instagram doesn't support direct URL sharing, so we'll copy to clipboard
    copyToClipboard(`${text}\n\n${window.location.href}`);
    showShareMessage('Link copied! You can now paste it in your Instagram story or post.');
}

function shareToFacebook() {
    const url = encodeURIComponent(window.location.href);
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
}

function shareToMessages() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent("üêæ Look at my pet's amazing story! üêæ");
    window.open(`sms:?body=${text}%20${url}`, '_blank');
}

function shareToLinkedIn() {
    const url = encodeURIComponent(window.location.href);
    const text = encodeURIComponent("üêæ Sharing my pet's incredible journey! üêæ");
    window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank');
}

function copyLink() {
    copyToClipboard(window.location.href);
    showShareMessage('Link copied to clipboard! üìã');
}

function copyToClipboard(text) {
    if (navigator.clipboard) {
        navigator.clipboard.writeText(text);
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
    }
}

function showShareMessage(message) {
    // Create a temporary message element
    const messageEl = document.createElement('div');
    messageEl.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: rgba(74, 144, 226, 0.95);
        color: white;
        padding: 15px 25px;
        border-radius: 25px;
        font-size: 14px;
        font-weight: 600;
        z-index: 10000;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    `;
    messageEl.textContent = message;
    document.body.appendChild(messageEl);
    
    // Remove after 3 seconds
    setTimeout(() => {
        if (messageEl.parentNode) {
            messageEl.parentNode.removeChild(messageEl);
        }
    }, 3000);
}

// Personalized Playback Functions
function goToPetProfile() {
    // Redirect to pet profile page or show modal
    showShareMessage('Redirecting to pet profile... üêæ');
    // You can replace this with actual redirect logic
    // window.location.href = '/pet-profile';
}

function contactSupport() {
    // Open support chat or contact form
    showShareMessage('Opening support chat... üí¨');
    // You can replace this with actual support integration
    // window.open('https://support.chewy.com', '_blank');
}
</script>
{% endblock %} 